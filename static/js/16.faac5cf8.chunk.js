"use strict";(self.webpackChunkszwagecalc=self.webpackChunkszwagecalc||[]).push([[16],{16:(e,t,r)=>{r.r(t),r.d(t,{default:()=>x});var a=r(379),o=r(43),i=r(446),n=r.n(i),s=r(521),l=r(312),d=r(253),c=r(994),m=r(328),u=(r(15),r(61)),g=r(579);const x=e=>{var t,r;let{selectedDate:i,isOpen:x,onClose:f,session:h,jobs:y,recordToEdit:v,size:b="medium",prefill:p}=e;const k=(0,d.d)(),w=(0,c.S)(),[F,j]=(0,o.useState)(""),[N,C]=(0,o.useState)(""),[_,D]=(0,o.useState)(0),[S,T]=(0,o.useState)(""),[L,E]=(0,o.useState)(0),[H,Y]=(0,o.useState)(null),[M,I]=(0,o.useState)(0),[A,B]=(0,o.useState)(!1),[q,z]=(0,o.useState)(null),[O,W]=(0,o.useState)("hourly"),[P,R]=(0,o.useState)(0),[V,$]=(0,o.useState)(!1),[G,J]=(0,o.useState)(!1),K=(0,o.useCallback)(()=>{j(""),C(""),D(0),T(""),E(0),Y(null),B(!1),W("hourly"),R(0),z(null)},[]);(0,o.useEffect)(()=>{y.length>0&&!q&&z(y[0].id)},[y,q]),(0,o.useEffect)(()=>{x?($(!0),setTimeout(()=>J(!0),10),document.body.classList.add("modal-open"),v?(Y(v.id),z(v.job_id),j(v.start_time?v.start_time.slice(0,5):""),C(v.end_time?v.end_time.slice(0,5):""),D(v.meal_allowance||0),T(v.notes||""),E(v.daily_wage||0),W(v.wage_type||"hourly"),"daily"===v.wage_type&&R(v.daily_wage||0)):(K(),y.length>0&&z(y[0].id),p&&(p.jobId&&z(p.jobId),p.start&&j(p.start),p.end&&C(p.end),p.wageType&&W(p.wageType)))):(J(!1),setTimeout(()=>$(!1),300),document.body.classList.remove("modal-open"))},[x,v,p,y,K]),(0,o.useEffect)(()=>{x||setTimeout(()=>{K()},350)},[x,K]),(0,o.useEffect)(()=>()=>{document.body.classList.remove("modal-open")},[]),(0,o.useEffect)(()=>{(async()=>{if(!h||!q||!i)return void I(0);const{data:e,error:t}=await l.N.from("hourly_rate_history").select("hourly_rate").eq("user_id",h.user.id).eq("job_id",q).lte("effective_date",n()(i).format("YYYY-MM-DD")).or("end_date.gte.".concat(n()(i).format("YYYY-MM-DD"),",end_date.is.null")).order("effective_date",{ascending:!1}).limit(1);t?(console.error("Error fetching hourly rate for date:",t),I(0)):e&&e.length>0?I(e[0].hourly_rate):I(0)})()},[h,q,i]),(0,o.useEffect)(()=>{if("hourly"===O)if(F&&N&&0!==M){const e=(0,s.C)(F);let t=(0,s.C)(N);if(!e||!t)return void E(0);if(t.isBefore(e))return B(!0),void E(0);B(!1);const r=t.diff(e,"minute")/60,a=Math.round(r*M)+_;E(a)}else E(0);else"daily"===O&&(B(!1),E(P+_))},[O,F,N,M,_,P]);if(!V)return null;const Q={small:"max-w-md",medium:"max-w-xl",large:"max-w-3xl",full:"max-w-full"}[b];return(0,g.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center transition-opacity duration-300 ease-out ".concat(G?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"," overflow-y-auto p-4 z-layer-modal"),children:(0,g.jsxs)("div",{className:"bg-cream-white dark:bg-charcoal-gray rounded-2xl shadow-lg p-6 w-full ".concat(Q," transform transition-all duration-300 ease-out ").concat(G?"translate-y-0 scale-100":"translate-y-10 scale-95"," my-auto"),children:[(0,g.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,g.jsx)("h2",{className:"text-xl font-bold text-dark-navy dark:text-white",children:v?"\uadfc\ubb34 \uae30\ub85d \ud3b8\uc9d1":"\uc0c8 \uadfc\ubb34 \uae30\ub85d"}),(0,g.jsx)("button",{onClick:f,className:"text-medium-gray dark:text-light-gray hover:text-dark-navy dark:hover:text-white text-2xl transition-all duration-200 ease-in-out transform hover:scale-105",children:"\xd7"})]}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc9c1\uc5c5 \uc120\ud0dd"}),(0,g.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:0===y.length?(0,g.jsx)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:"\uc9c1\uc5c5\uc744 \ucd94\uac00\ud574\uc8fc\uc138\uc694"}):y.map(e=>(0,g.jsx)("button",{onClick:()=>z(e.id),className:"px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 hover:scale-105 transform",style:(0,u.B)(e,q===e.id),children:e.job_name},e.id))})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-medium-gray dark:text-light-gray mb-2",children:"\uae09\uc5ec \ubc29\uc2dd"}),(0,g.jsxs)("div",{className:"flex gap-2",children:[(0,g.jsx)("button",{onClick:()=>W("hourly"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 ".concat("hourly"===O?"bg-mint-green text-white":"bg-gray-200 text-dark-navy dark:bg-gray-700 dark:text-white"),children:"\uc2dc\uae09\uc81c"}),(0,g.jsx)("button",{onClick:()=>W("daily"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 ".concat("daily"===O?"bg-mint-green text-white":"bg-gray-200 text-dark-navy dark:bg-gray-700 dark:text-white"),children:"\uc77c\uae09\uc81c"})]})]}),"hourly"===O&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"hourlyRateDisplay",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc801\uc6a9 \uc2dc\uae09"}),(0,g.jsx)("input",{type:"text",id:"hourlyRateDisplay",value:"".concat(null!=M?M.toLocaleString():"0","\uc6d0"),readOnly:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md  bg-gray-100 dark:bg-gray-700 text-dark-navy dark:text-white sm:text-sm"})]}),"daily"===O&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"fixedDailyWage",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc77c\uae09 (\uc6d0)"}),(0,g.jsx)("input",{type:"number",id:"fixedDailyWage",value:P||"",onChange:e=>R(Math.max(0,parseInt(e.target.value)||0)),placeholder:"\uc608: 150000",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]}),(0,g.jsxs)("div",{className:"flex gap-4",children:[(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("label",{htmlFor:"startTime",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ucd9c\uadfc \uc2dc\uac04"}),(0,g.jsx)(m.Ay,{id:"startTime",selected:/^\d{2}:\d{2}$/.test(F)&&(null===(t=(0,s.C)(F))||void 0===t?void 0:t.toDate())||null,onChange:e=>{if(!e)return void j("");const t=n()(e);t.isValid()?j(t.format("HH:mm")):j("")},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,dateFormat:"HH:mm",timeFormat:"HH:mm",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white",inputProps:{autoComplete:"off"}})]}),(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("label",{htmlFor:"endTime",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ud1f4\uadfc \uc2dc\uac04"}),(0,g.jsx)(m.Ay,{id:"endTime",selected:/^\d{2}:\d{2}$/.test(N)&&(null===(r=(0,s.C)(N))||void 0===r?void 0:r.toDate())||null,onChange:e=>{if(!e)return void C("");const t=n()(e);t.isValid()?C(t.format("HH:mm")):C("")},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,dateFormat:"HH:mm",timeFormat:"HH:mm",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white",inputProps:{autoComplete:"off"}})]})]}),A&&(0,g.jsx)("p",{className:"text-red-500 text-xs mt-1",children:"\ud1f4\uadfc \uc2dc\uac04\uc740 \ucd9c\uadfc \uc2dc\uac04\ubcf4\ub2e4 \ub2a6\uc5b4\uc57c \ud574\uc694."}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"mealAllowance",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc2dd\ub300 (\uc6d0)"}),(0,g.jsx)("input",{type:"number",id:"mealAllowance",value:_||"",onChange:e=>D(Math.max(0,parseInt(e.target.value)||0)),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ube44\uace0"}),(0,g.jsx)("textarea",{id:"notes",rows:"2",value:S||"",onChange:e=>T(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]})]}),(0,g.jsxs)("div",{className:"mt-6 text-right text-lg font-semibold text-mint-green",children:["\uc608\uc0c1 \uc77c\uae09: ",L.toLocaleString(),"\uc6d0"]}),(0,g.jsxs)("div",{className:"mt-6 flex flex-col-reverse gap-3",children:[H&&(0,g.jsx)("button",{onClick:async()=>{H?w("\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc5b4\uc694?",async()=>{try{const{error:e}=await l.N.from("work_records").delete().eq("id",H);if(e)throw e;k("\uc0ad\uc81c\ud588\uc5b4\uc694","success"),f(),K()}catch(e){console.error("\uadfc\ubb34 \uae30\ub85d \uc0ad\uc81c \uc624\ub958:",e),k("\uc0ad\uc81c\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")}}):k("\uc0ad\uc81c\ud560 \uae30\ub85d\uc774 \uc5c6\uc5b4\uc694","error")},className:"w-full px-6 py-3 text-white bg-coral-pink rounded-full font-medium hover:bg-coral-pink-dark focus:outline-none focus:ring-2 focus:ring-coral-pink focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\uc0ad\uc81c"}),(0,g.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,g.jsx)("button",{onClick:f,className:"w-full px-3 py-2 bg-medium-gray text-white rounded-full font-medium hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-medium-gray focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\ucde8\uc18c"}),(0,g.jsx)("button",{onClick:K,className:"w-full px-3 py-2 bg-gray-200 text-dark-navy rounded-full font-medium hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-200 focus:ring-opacity-50 transition-all duration-200  ease-in-out transform hover:scale-105 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",children:"\ucd08\uae30\ud654"}),(0,g.jsx)("button",{onClick:async()=>{if(!h||!q||!i)return void k("\ud544\uc218 \uc815\ubcf4\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if("hourly"===O){if(!F||!N)return void k("\uc2dc\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if(0===M)return void k("\ud574\ub2f9 \uc9c1\uc5c5\uc758 \uc2dc\uae09\uc744 \uc124\uc815\ud574\uc8fc\uc138\uc694.","error");const e=(0,s.C)(F),t=(0,s.C)(N);if(!e||!t)return void k("\uc2dc\uac04 \ud615\uc2dd\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.","error");if(t.isBefore(e))return void k("\ud1f4\uadfc \uc2dc\uac04\uc744 \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.","error")}else if("daily"===O){if(P<=0)return void k("\uc77c\uae09\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if(!F||!N)return void k("\uadfc\ubb34\uc2dc\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");const e=(0,s.C)(F),t=(0,s.C)(N);if(!e||!t)return void k("\uc2dc\uac04 \ud615\uc2dd\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.","error");if(t.isBefore(e))return void k("\ud1f4\uadfc \uc2dc\uac04\uc744 \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.","error")}let e={user_id:h.user.id,job_id:q,date:n()(i).format("YYYY-MM-DD"),meal_allowance:_,notes:S,wage_type:O,work_description:S};if("hourly"===O){const t=(0,s.C)(F),r=(0,s.C)(N).diff(t,"minute")/60,o=Math.round(r*M)+_;e=(0,a.A)((0,a.A)({},e),{},{start_time:F,end_time:N,daily_wage:o})}else"daily"===O&&(e=(0,a.A)((0,a.A)({},e),{},{start_time:F,end_time:N,daily_wage:P+_}));try{if(H){const{error:t}=await l.N.from("work_records").update(e).eq("id",H);if(t)throw t;k("\uc218\uc815\ud588\uc5b4\uc694","success")}else{const{error:t}=await l.N.from("work_records").insert([e]);if(t)throw t;k("\uc800\uc7a5\ud588\uc5b4\uc694","success")}try{window.dispatchEvent(new Event("work-records-changed"))}catch(t){}f(),K()}catch(r){console.error("\uadfc\ubb34 \uae30\ub85d \uc800\uc7a5 \uc624\ub958:",r),k("\uc800\uc7a5\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")}},className:"w-full px-3 py-2 bg-mint-green text-white rounded-full font-medium hover:bg-mint-green-dark focus:outline-none focus:ring-2 focus:ring-mint-green focus:ring-opacity-50 transition-all duration-200  ease-in-out transform hover:scale-105",children:"\uc800\uc7a5"})]})]})]})})}},61:(e,t,r)=>{r.d(t,{B:()=>n,j:()=>a});const a=[{id:"brand-purple",name:"\ube0c\ub79c\ub4dc \ud37c\ud50c",value:"var(--accent-primary)",textLight:"var(--accent-text)",textDark:"var(--accent-text)",inactive:"rgba(139, 92, 246, 0.25)"},{id:"success-green",name:"\uc11d\uc138\uc2a4 \uadf8\ub9b0",value:"var(--success-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(34, 197, 94, 0.25)"},{id:"warning-orange",name:"\uc6cc\ub2dd \uc624\ub80c\uc9c0",value:"var(--warning-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(249, 115, 22, 0.25)"},{id:"error-red",name:"\uc5d0\ub7ec \ub808\ub4dc",value:"var(--error-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(239, 68, 68, 0.25)"},{id:"blue",name:"\ube14\ub8e8",value:"#2563EB",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(37, 99, 235, 0.25)"},{id:"fuchsia",name:"\ud4e8\uc2dc\uc544",value:"#C026D3",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(192, 38, 211, 0.25)"},{id:"coffee-brown",name:"\ucee4\ud53c \ube0c\ub77c\uc6b4",value:"#8B5E3C",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(139, 94, 60, 0.25)"}],o=a[0],i=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=a.find(t=>t.value===e);if(r)return t?r.textDark:r.textLight;if(!e)return t?"#FFFFFF":"#1F2937";if(e.startsWith("var("))return"var(--text-inverse)";const o=e.replace("#","");return(.299*parseInt(o.substr(0,2),16)+.587*parseInt(o.substr(2,2),16)+.114*parseInt(o.substr(4,2),16))/255>.5?"#1F2937":"#FFFFFF"},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.color||o.value,s=(l=n,a.find(e=>e.value===l)||o);var l;return t?{backgroundColor:n,color:i(n,r),borderColor:n}:{backgroundColor:s?s.inactive:"rgba(0,0,0,0.1)",color:"var(--text-secondary)",borderColor:s?s.inactive:"rgba(0,0,0,0.1)"}}}}]);