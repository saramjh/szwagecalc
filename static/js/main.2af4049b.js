(()=>{"use strict";var e={253:(e,t,r)=>{r.d(t,{a:()=>i,b:()=>l});var a=r(5043),n=r(579);const o=e=>{let{message:t,type:r}=e,a="";switch(r){case"success":a="bg-mint-green";break;case"error":a="bg-coral-pink";break;default:a="bg-medium-gray"}return(0,n.jsx)("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg text-white text-center z-layer-toast transition-all duration-300 ease-out ".concat(a),children:t})},s=(0,a.createContext)(null),i=e=>{let{children:t}=e;const[r,i]=(0,a.useState)(null),l=(0,a.useCallback)(function(e){i({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"}),setTimeout(()=>{i(null)},3e3)},[]);return(0,n.jsxs)(s.Provider,{value:l,children:[t,r&&(0,n.jsx)(o,{message:r.message,type:r.type})]})},l=()=>{const e=(0,a.useContext)(s);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}},2521:(e,t,r)=>{r.d(t,{a:()=>o});var a=r(446),n=r.n(a);function o(e){if(!e||"string"!==typeof e)return null;const[t,r]=e.split(":"),a=parseInt(t,10),o=parseInt(r,10);return Number.isNaN(a)||Number.isNaN(o)?null:n()().startOf("day").add(a,"hour").add(o,"minute")}},5843:(e,t,r)=>{r.d(t,{a:()=>a});const a=(0,r(3714).a)("https://llvtylnqjemgsnvbfxch.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxsdnR5bG5xamVtZ3NudmJmeGNoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NTQwMzcsImV4cCI6MjA2NzEzMDAzN30.958ygywMsGKOY3B7TXkt1uf4KcvLbx-drncTycJZh5g",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:localStorage}})},6632:(e,t,r)=>{r.d(t,{a:()=>o,b:()=>g,c:()=>l,d:()=>m,e:()=>u,f:()=>d,g:()=>c,h:()=>h});var a=r(446),n=r.n(a);const o=[{minHours:4,maxHours:8,breakMinutes:30},{minHours:8,maxHours:12,breakMinutes:60}],s=new Map;function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="".concat(Math.round(100*e)/100,"-").concat(t.id||"default","-").concat(t.break_time_enabled,"-").concat(JSON.stringify(t.break_time_policies||[]));if(s.has(r))return s.get(r);if(!1===t.break_time_enabled)return{breakMinutes:0,breakHours:0,isPaid:!1};const a=t.break_time_policies||o,n=t.break_time_paid||!1;let i=null;for(const o of a)if(e>=o.minHours&&e<o.maxHours){i=o;break}if(!i)return{breakMinutes:0,breakHours:0,isPaid:n};const l=i.breakMinutes,d={breakMinutes:l,breakHours:Math.round(l/60*100)/100,isPaid:n};if(s.size>=1e3){const e=s.keys().next().value;s.delete(e)}return s.set(r,d),d}function l(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return{workHours:0,breakTime:{breakMinutes:0,breakHours:0,isPaid:!1},totalHours:0};const[a,o]=e.split(":").map(Number),[s,l]=t.split(":").map(Number),d=n()().hour(a).minute(o);let c=n()().hour(s).minute(l);c.isBefore(d)&&(c=c.add(1,"day"));const u=c.diff(d,"minute")/60,m=i(u,r),h=u-m.breakMinutes/60;return{workHours:Math.round(100*h)/100,breakTime:m,totalHours:Math.round(100*u)/100}}function d(e){if(0===e)return"\ud734\uac8c\uc2dc\uac04 \uc5c6\uc74c";const t=Math.floor(e/60),r=e%60;return 0===t?"".concat(r,"\ubd84"):0===r?"".concat(t,"\uc2dc\uac04"):"".concat(t,"\uc2dc\uac04 ").concat(r,"\ubd84")}function c(e){if(!Array.isArray(e)||0===e.length)return!1;for(const t of e)if("number"!==typeof t.minHours||"number"!==typeof t.maxHours||"number"!==typeof t.breakMinutes||t.minHours<0||t.maxHours<=t.minHours||t.breakMinutes<0)return!1;return!0}function u(e,t,r){return{minHours:Number(e),maxHours:Number(t),breakMinutes:Number(r)}}function m(){s.clear()}function h(e){if(!Array.isArray(e))return;const t=[4,6,8,10,12];e.forEach(e=>{e.break_time_enabled&&e.break_time_policies&&t.forEach(t=>{i(t,e)})})}function g(e,t,r,a){if(!e||!t||!r||!a)return{breakTimePaid:0,breakTimeUnpaid:0,wageDifference:0};const n=l(e,t,r);if(0===n.breakTime.breakMinutes)return{breakTimePaid:0,breakTimeUnpaid:0,wageDifference:0};const o=n.breakTime.breakHours,s=Math.round(o*a);return n.breakTime.isPaid?{breakTimePaid:s,breakTimeUnpaid:0,wageDifference:0}:{breakTimePaid:0,breakTimeUnpaid:s,wageDifference:s}}},7240:(e,t,r)=>{var a=r(5043),n=r(7950),o=r(446),s=r.n(o),i=r(6865),l=r.n(i),d=r(7140),c=r.n(d),u=r(1525),m=r.n(u),h=r(4462),g=r.n(h),f=r(8933),x=r.n(f);r(8456);s().extend(l()),s().extend(c()),s().extend(m()),s().extend(g()),s().extend(x()),s().locale("ko");const b=s();var p=r(8521),y=r(2521),w=r(5843),v=r(6632);function k(e){if(!e.start_time||!e.end_time)return 0;const[t,r]=String(e.start_time).split(":").map(e=>parseInt(e,10)),[a,n]=String(e.end_time).split(":").map(e=>parseInt(e,10));if(Number.isNaN(t)||Number.isNaN(r)||Number.isNaN(a)||Number.isNaN(n))return 0;const o=s()().startOf("day"),i=o.add(t,"hour").add(r,"minute");let l=o.add(a,"hour").add(n,"minute");return l.isBefore(i)&&(l=l.add(1,"day")),l.diff(i,"minute")/60}function j(e){if("daily"===e.wage_type)return e.daily_wage||0;if(e.start_time&&e.end_time&&e.jobs){const t=(0,v.c)(e.start_time,e.end_time,e.jobs);if(0===t.breakTime.breakMinutes||!t.breakTime.isPaid){let r=t.workHours;t.breakTime.isPaid&&(r=t.totalHours);const a=(e.daily_wage||0)-(e.meal_allowance||0);let n=t.workHours;t.breakTime.isPaid&&(n=t.totalHours);const o=Math.round(a/(n||1));return Math.round(r*o)+(e.meal_allowance||0)}}return e.daily_wage||0}function N(e,t){const r=function(e,t){const r=s()(t);return(e||[]).filter(e=>s()(e.date).isSame(r,"month"))}(e,t);let a=0,n=0;for(const o of r)a+=j(o),n+=k(o);return{totalIncome:a,totalHours:n,averageHourly:n>0?Math.round(a/n):0}}var _=r(579);const S=e=>{let{context:t,userProgress:r={},onAction:n}=e;const[o,s]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>({"empty-calendar":{title:"\uccab \uadfc\ubb34\ub97c \uae30\ub85d\ud574\ubcf4\uc138\uc694!",message:"\ub2ec\ub825\uc5d0\uc11c \uadfc\ubb34\ud55c \ub0a0\uc9dc\ub97c \uc120\ud0dd\ud558\uba74 \uc27d\uac8c \uae30\ub85d\ud560 \uc218 \uc788\uc5b4\uc694",action:{text:"\uc624\ub298 \uae30\ub85d\ud558\uae30",type:"add-today"},condition:()=>!r.hasRecords,priority:"high"},"no-jobs":{title:"\uc9c1\uc5c5\uc744 \uba3c\uc800 \uc124\uc815\ud574\uc8fc\uc138\uc694",message:"\uc815\ud655\ud55c \uae09\uc5ec \uacc4\uc0b0\uc744 \uc704\ud574 \uc9c1\uc5c5 \uc815\ubcf4\uac00 \ud544\uc694\ud574\uc694",action:{text:"\uc9c1\uc5c5 \ucd94\uac00\ud558\uae30",type:"open-job-management"},condition:()=>!r.hasJobs,priority:"critical"},"no-hourly-rate":{title:"\uc2dc\uae09\uc744 \uc124\uc815\ud574\uc8fc\uc138\uc694",message:"\uc2dc\uae09\uc744 \uc124\uc815\ud558\uba74 \uc790\ub3d9\uc73c\ub85c \uae09\uc5ec\ub97c \uacc4\uc0b0\ud574\ub4dc\ub824\uc694",icon:p.q,action:{text:"\uc2dc\uae09 \uc124\uc815\ud558\uae30",type:"open-hourly-rate"},condition:()=>r.hasJobs&&!r.hasHourlyRate,priority:"high"},"break-time-benefit":{title:"\ud734\uac8c\uc2dc\uac04 \ucc28\uc561\uc744 \ud655\uc778\ud574\ubcf4\uc138\uc694 \u2615",message:"\ud734\uac8c\uc2dc\uac04\uc73c\ub85c \uc778\ud55c \uae09\uc5ec \ucc28\uc774\ub97c \ubd84\uc11d\ud574\ub4dc\ub824\uc694",action:{text:"\uc0c1\uc138 \ubcf4\uae30",type:"show-break-analysis"},condition:()=>r.hasRecords&&r.hasBreakTimeDifference,priority:"medium"},"weekly-allowance-eligible":{title:"\uc8fc\ud734\uc218\ub2f9 \ub300\uc0c1\uc774\uc5d0\uc694!",message:"\uc774\ubc88 \uc8fc 15\uc2dc\uac04 \uc774\uc0c1 \uadfc\ubb34\ud574\uc11c \uc8fc\ud734\uc218\ub2f9\uc744 \ubc1b\uc744 \uc218 \uc788\uc5b4\uc694",icon:p.E,action:{text:"\uc8fc\ud734\uc218\ub2f9 \ubcf4\uae30",type:"show-weekly-allowance"},condition:()=>r.weeklyHours>=15,priority:"medium"},"monthly-summary":{title:"\uc774\ubc88 \ub2ec \uc815\uc0b0\uc744 \ud655\uc778\ud574\ubcf4\uc138\uc694",message:"\uc6d4\ub9d0\uc774 \ub2e4\uac00\uc654\uc5b4\uc694. \uc774\ubc88 \ub2ec \uae09\uc5ec\ub97c \uc815\ub9ac\ud574\ubcf4\uc138\uc694",icon:p.g,action:{text:"\uc6d4\uae09 \ud655\uc778",type:"open-monthly-report"},condition:()=>r.hasRecords&&(new Date).getDate()>25,priority:"low"}}),[r]),m=(0,a.useCallback)(()=>{const e=u[t];return e&&e.condition()?e:null},[t,u]);(0,a.useEffect)(()=>{const e=m();c(!!e&&!i),e&&!i&&setTimeout(()=>s(!0),500)},[t,r,i,m]);const h=m();if(!d||!h)return null;const g=()=>{s(!1),setTimeout(()=>{l(!0),c(!1)},200)},f=(e=>{switch(e){case"critical":return{bg:"bg-gradient-to-r from-red-500 to-pink-500",border:"border-red-200",text:"text-white",action:"bg-white text-red-600 hover:bg-red-50"};case"high":default:return{bg:"bg-gradient-to-r from-mint-green to-emerald-500",border:"border-mint-200",text:"text-white",action:"bg-white text-mint-600 hover:bg-mint-50"};case"medium":return{bg:"bg-gradient-to-r from-blue-500 to-indigo-500",border:"border-blue-200",text:"text-white",action:"bg-white text-blue-600 hover:bg-blue-50"};case"low":return{bg:"bg-gradient-to-r from-gray-600 to-gray-700",border:"border-gray-200",text:"text-white",action:"bg-white text-gray-600 hover:bg-gray-50"}}})(h.priority);return(0,_.jsx)("div",{className:"fixed bottom-4 left-4 right-4 z-50 transition-all duration-300 transform ".concat(o?"translate-y-0 opacity-100":"translate-y-full opacity-0"," max-w-sm mx-auto"),children:(0,_.jsxs)("div",{className:"".concat(f.bg," rounded-2xl shadow-xl p-4 ").concat(f.border," border backdrop-blur-sm"),children:[(0,_.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,_.jsx)("div",{className:"flex-shrink-0",children:h.icon?(0,_.jsx)(h.icon,{className:"w-6 h-6 ".concat(f.text)}):(0,_.jsx)(p.s,{className:"w-6 h-6 ".concat(f.text)})}),(0,_.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,_.jsx)("h3",{className:"font-semibold text-sm ".concat(f.text," mb-1"),children:h.title}),(0,_.jsx)("p",{className:"text-xs ".concat(f.text," opacity-90 mb-3 leading-relaxed"),children:h.message}),(0,_.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,_.jsxs)("button",{onClick:()=>{null===n||void 0===n||n(h.action.type),g()},className:"px-3 py-1.5 rounded-lg text-xs font-medium ".concat(f.action," transition-all duration-200 transform hover:scale-105 flex items-center space-x-1"),children:[(0,_.jsx)("span",{children:h.action.text}),(0,_.jsx)(p.d,{className:"w-3 h-3 rotate-45"})]}),(0,_.jsx)("button",{onClick:g,className:"p-1.5 rounded-lg ".concat(f.text," hover:bg-white hover:bg-opacity-20 transition-all duration-200"),children:(0,_.jsx)(p.K,{className:"w-4 h-4"})})]})]})]}),(0,_.jsx)("div",{className:"absolute top-0 right-0 w-16 h-16 bg-white opacity-10 rounded-full -mr-8 -mt-8"}),(0,_.jsx)("div",{className:"absolute bottom-0 left-0 w-8 h-8 bg-white opacity-5 rounded-full -ml-4 -mb-4"})]})})},M=(0,a.lazy)(()=>Promise.all([r.e(96),r.e(908)]).then(r.bind(r,3908))),E=(0,a.lazy)(()=>r.e(685).then(r.bind(r,6685))),C=(0,a.lazy)(()=>r.e(39).then(r.bind(r,39))),Y=(0,a.lazy)(()=>r.e(33).then(r.bind(r,2033))),D=(0,a.lazy)(()=>r.e(975).then(r.bind(r,2975))),T=(0,a.lazy)(()=>Promise.all([r.e(96),r.e(16)]).then(r.bind(r,5016))),O=(0,a.lazy)(()=>r.e(200).then(r.bind(r,5200))),I=(0,a.lazy)(()=>r.e(887).then(r.bind(r,6887))),L=(0,a.lazy)(()=>r.e(596).then(r.bind(r,8596))),H=e=>{let{onOpenHourlyRateModal:t,session:r,jobs:n}=e;const[o,i]=(0,a.useState)(new Date),[l,d]=(0,a.useState)([]),[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[g,f]=(0,a.useState)(!1),[x,v]=(0,a.useState)(new Date),[k,j]=(0,a.useState)(!1),[H,P]=(0,a.useState)(!1),[z,R]=(0,a.useState)(!1),[A,q]=(0,a.useState)(!1),[B,U]=(0,a.useState)(0),[J,W]=(0,a.useState)(()=>"true"===localStorage.getItem("guide-progress-checkedReport")),[F,G]=(0,a.useState)(()=>"true"===localStorage.getItem("guide-progress-setHourlyRate"));(0,a.useEffect)(()=>{localStorage.setItem("guide-progress-checkedReport",J.toString())},[J]),(0,a.useEffect)(()=>{localStorage.setItem("guide-progress-setHourlyRate",F.toString())},[F]);const[X,V]=(0,a.useState)({totalIncome:0,totalHours:0,averageHourly:0,nextPaydayText:""}),[Z,K]=(0,a.useState)(!1),[Q,$]=(0,a.useState)(null),[ee,te]=(0,a.useState)(null),re=(0,a.useRef)(null);(0,a.useEffect)(()=>{const e=e=>{if(!re.current)return;const t=re.current.contains(e.target);("touch"===e.pointerType||"mouse"===e.pointerType)&&(t||te(null))},t=()=>te(null);return document.addEventListener("pointerdown",e,!0),window.addEventListener("scroll",t,!0),window.addEventListener("resize",t),()=>{document.removeEventListener("pointerdown",e,!0),window.removeEventListener("scroll",t,!0),window.removeEventListener("resize",t)}},[]),(0,a.useEffect)(()=>{te(null)},[o,m,g,c,k]);const ae=(0,a.useCallback)(async()=>{try{let e=r&&r.user?r.user.id:null;if(!e){const{data:t}=await w.a.auth.getUser();e=t&&t.user?t.user.id:null}if(!e)return;const t=b(o),a=t.subtract(1,"month").startOf("month").format("YYYY-MM-DD"),n=t.add(1,"month").endOf("month").format("YYYY-MM-DD"),{data:s,error:i}=await w.a.from("work_records").select("*, jobs(job_name)").eq("user_id",e).gte("date",a).lte("date",n).order("date",{ascending:!1});if(i)return void console.error("Error fetching work records:",i);d(Array.isArray(s)?s:[])}catch(e){console.error("Unexpected error fetching work records:",e)}},[r,o]);(0,a.useEffect)(()=>{r&&ae()},[r,ae]),(0,a.useEffect)(()=>{ae()},[]),(0,a.useEffect)(()=>{if(!r)return;const e=b(o),t=e.subtract(1,"month").startOf("month").format("YYYY-MM-DD"),a=e.add(1,"month").endOf("month").format("YYYY-MM-DD"),n=w.a.channel("work_records_".concat(e.format("YYYY-MM"))).on("postgres_changes",{event:"*",schema:"public",table:"work_records",filter:"user_id=eq.".concat(r.user.id,"&date=gte.").concat(t,"&date=lte.").concat(a)},e=>{var t;console.log("\ud83d\udce1 \uc2e4\uc2dc\uac04 \uc5c5\ub370\uc774\ud2b8:",e.eventType,null===(t=e.new)||void 0===t?void 0:t.date),ae()}).subscribe();return()=>{try{w.a.removeChannel(n)}catch(e){}}},[r,ae,o]),(0,a.useEffect)(()=>{const e=()=>ae();return window.addEventListener("work-records-changed",e),()=>window.removeEventListener("work-records-changed",e)},[ae]);const ne=(0,a.useMemo)(()=>{const e=N(l,o),t=function(e,t){const r=s()(t);let a=null;for(const n of e||[]){if(!n.payday)continue;const e=r.date(n.payday),t=e.isBefore(r,"day")?r.add(1,"month").date(n.payday):e;a&&!t.isBefore(a.date)||(a={job:n,date:t})}return a}(n,o);return{totalIncome:e.totalIncome,totalHours:e.totalHours,averageHourly:e.averageHourly,nextPaydayText:t?"".concat(t.date.format("M\uc6d4 D\uc77c")):"\u2014"}},[l,n,o]);(0,a.useEffect)(()=>{V(ne)},[ne]);const oe=e=>{h(e);const t=b(e).format("YYYY-MM-DD");if(0===l.filter(e=>e.date===t).length){const e=n&&n.length>0?n[0].id:null;$({jobId:e,start:"13:00",end:"17:00",wageType:"hourly"}),K(!0)}else u(!0)},se=(0,a.useMemo)(()=>({hasJobs:n&&n.length>0,hasRecords:l&&l.length>0,hasHourlyRate:F,checkedReport:J,weeklyHours:0,hasBreakTimeDifference:!1}),[n,l,F,J]),ie=()=>{G(!0),null===t||void 0===t||t()},le=e=>n.filter(t=>{if(!t.payday)return!1;const r=e.getFullYear(),a=e.getMonth(),n=new Date(r,a+1,0).getDate(),o=Math.min(t.payday,n);return e.getDate()===o});return(0,_.jsxs)("div",{className:"p-4 relative z-0  w-full",children:[(0,_.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,_.jsxs)("div",{className:"w-full bg-white dark:bg-gray-800 rounded-xl shadow dark:shadow-lg p-3 flex justify-between",children:[(0,_.jsx)("div",{className:"text-sm text-medium-gray dark:text-gray-300",children:"\uc774\ubc88\ub2ec \uc2dc\uae09 \ub204\uc801"}),(0,_.jsxs)("div",{className:"text-base font-bold text-dark-navy dark:text-white",children:[(X.totalIncome||0).toLocaleString(),"\uc6d0 \xb7 ",Number.isFinite(X.totalHours)?X.totalHours.toFixed(1):"0.0","h"]})]}),(0,_.jsx)(a.Suspense,{fallback:(0,_.jsx)("div",{className:"w-full h-20 bg-gray-100 dark:bg-gray-800 rounded-xl animate-pulse"}),children:(0,_.jsx)(O,{workRecords:l,jobs:n,selectedDate:o})}),(0,_.jsxs)("div",{className:"w-full bg-white dark:bg-gray-800 rounded-xl shadow dark:shadow-lg p-3 flex justify-between",children:[(0,_.jsx)("div",{className:"text-sm text-medium-gray dark:text-gray-300",children:"\ub2e4\uc74c \uae09\uc5ec\uc77c"}),(0,_.jsx)("div",{className:"text-base font-bold text-dark-navy dark:text-white",children:X.nextPaydayText})]})]}),(0,_.jsxs)("div",{className:"bg-cream-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-xl p-4",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,_.jsx)("button",{onClick:()=>i(b(o).subtract(1,"month").toDate()),className:"px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-dark-navy dark:text-white",children:"\u25c0"}),(0,_.jsx)("div",{className:"text-lg sm:text-xl font-bold text-dark-navy dark:text-white",children:b(o).format("YYYY\ub144 M\uc6d4")}),(0,_.jsx)("button",{onClick:()=>i(b(o).add(1,"month").toDate()),className:"px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-dark-navy dark:text-white",children:"\u25b6"})]}),(0,_.jsx)("div",{className:"grid grid-cols-7 text-center text-xs sm:text-sm text-medium-gray dark:text-gray-300 mb-1",children:["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"].map((e,t)=>(0,_.jsx)("div",{className:"py-1 ".concat(0===t?"text-coral-pink":6===t?"text-mint-green-light":""),children:e},e))}),(0,_.jsx)("div",{className:"grid grid-cols-7 calendar-grid",children:(()=>{const e=b(o),t=e.startOf("month"),r=e.daysInMonth(),a=t.day(),n=7*Math.ceil((a+r)/7),s=[],i=new Map;for(const o of l){const e=o.date;i.set(e,(i.get(e)||0)+(o.daily_wage||0))}const d=Array.from(i.values()),c=d.length?Math.max(...d):0,u=e=>{if(!c||!e)return 0;const t=e/c;return t>=.9?5:t>=.7?4:t>=.5?3:t>=.3?2:1};for(let o=0;o<n;o++){const e=o-a+1,n=e>=1&&e<=r,d=n?t.add(e-1,"day").toDate():null;if(!n){s.push((0,_.jsx)("div",{className:"calendar-cell",children:(0,_.jsx)("div",{className:"calendar-cell-inner cell-stroke bg-transparent"})},"empty-".concat(o)));continue}const c=le(d),m=b(d).format("YYYY-MM-DD"),h=l.filter(e=>e.date===m),g=b().isSame(b(d),"day"),f=b(d).day(),x=u(i.get(m)||0),p=h.length,w=(h.reduce((e,t)=>{if(!t.start_time||!t.end_time)return e;const r=(0,y.a)(t.start_time);let a=(0,y.a)(t.end_time);return r&&a?(a.isBefore(r)&&(a=a.add(1,"day")),e+a.diff(r,"minute")):e},0)/60).toFixed(1);s.push((0,_.jsx)("div",{className:"calendar-cell",children:(0,_.jsxs)("button",{onClick:()=>oe(d),"data-tour":g?"calendar-date":void 0,className:"calendar-cell-inner cell-stroke hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors heat-".concat(x," ").concat(c.length>0?"payday-ring":""," ").concat(g?"today-ring today-pulse":""),children:[(0,_.jsx)("div",{className:"calendar-day text-xs sm:text-sm font-semibold ".concat(0===f?"text-coral-pink":6===f?"text-mint-green-light":"text-dark-navy dark:text-white"),children:e}),(0,_.jsx)("div",{className:"calendar-badge",children:p>0&&(0,_.jsxs)("span",{className:"badge-pill",children:[(0,_.jsx)("span",{className:"badge-count",children:p}),(0,_.jsxs)("span",{className:"badge-text",children:[w,"h"]})]})})]})},m))}return s})()}),(()=>{const e=b(m||o).startOf("week"),t=e.endOf("week"),r="".concat(e.format("M/D")," - ").concat(t.format("M/D")),a=b().isBetween(e,t,"day","[]"),n=(l||[]).reduce((e,t)=>{const r=b(t.date).format("YYYY-MM-DD");return e[r]=(e[r]||0)+(t.daily_wage||0),e},{}),s=Array.from({length:7}).map((t,r)=>e.add(r,"day").format("YYYY-MM-DD")).map(e=>n[e]||0),i=Math.max(...s,1),d=s.reduce((e,t)=>e+t,0);return(0,_.jsxs)("div",{className:"mt-4",children:[(0,_.jsxs)("div",{className:"flex items-center justify-between mb-2 px-1",children:[(0,_.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[(0,_.jsx)(p.g,{className:"w-4 h-4 mr-1.5 text-mint-green"}),r," \uc218\uc785 \ud604\ud669",a&&(0,_.jsx)("span",{className:"ml-2 text-xs bg-mint-green text-white px-2 py-0.5 rounded-full",children:"\uc774\ubc88 \uc8fc"})]}),(0,_.jsxs)("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[d.toLocaleString(),"\uc6d0"]})]}),(0,_.jsxs)("div",{ref:re,className:"bg-white dark:bg-gray-700 rounded-lg shadow dark:shadow-lg select-none p-2",children:[(0,_.jsxs)("div",{className:"relative h-20 rounded-md",children:[(0,_.jsx)("div",{className:"absolute inset-0 pointer-events-none opacity-60",style:{background:"repeating-linear-gradient(to top, rgba(0,0,0,0.06), rgba(0,0,0,0.06) 1px, transparent 1px, transparent 16px)"}}),(0,_.jsx)("div",{className:"relative flex items-end h-full gap-2 w-full",children:s.map((e,t)=>{const r=Math.max(4,Math.round(e/i*80));return(0,_.jsxs)("div",{className:"relative flex-1 min-w-0 flex justify-center",onPointerEnter:e=>{"mouse"===e.pointerType&&te(t)},onPointerLeave:e=>{"mouse"===e.pointerType&&te(null)},onPointerDown:e=>{"touch"===e.pointerType&&te(t),"mouse"===e.pointerType&&te(t)},role:"button","aria-label":"\uc218\uc785 ".concat(e.toLocaleString(),"\uc6d0"),children:[(0,_.jsx)("div",{className:"w-8 bg-mint-green rounded-t-md shadow-sm",style:{height:"".concat(r,"px")}}),ee===t&&e>0&&(0,_.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2",style:{bottom:"".concat(r+6,"px")},children:(0,_.jsxs)("div",{className:"relative inline-block whitespace-nowrap",children:[(0,_.jsxs)("div",{className:"px-2 py-1 bg-white dark:bg-gray-900 border border-mint-green text-[12px] font-semibold text-dark-navy dark:text-white rounded-full shadow",children:["+",e.toLocaleString(),"\uc6d0"]}),(0,_.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-[6px] w-0 h-0 border-l-[8px] border-l-transparent border-r-[8px] border-r-transparent border-t-[8px] border-t-mint-green"}),(0,_.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-[5px] w-0 h-0 border-l-[7px] border-l-transparent border-r-[7px] border-r-transparent border-t-[7px] dark:border-t-gray-900 border-t-white"})]})})]},t)})})]}),(0,_.jsx)("div",{className:"mt-1 flex gap-2",children:s.map((e,t)=>(0,_.jsx)("div",{className:"flex-1 min-w-0 text-center",children:(0,_.jsx)("div",{className:"text-[11px] text-medium-gray dark:text-gray-400",children:["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"][t]})},"label-".concat(t)))})]})]})})()]}),(0,_.jsx)("div",{className:"mt-6 mb-6",children:(0,_.jsx)(a.Suspense,{fallback:(0,_.jsx)("div",{className:"w-full h-20 bg-gray-100 dark:bg-gray-800 rounded-xl animate-pulse"}),children:(0,_.jsx)(I,{selectedDate:o,workRecords:l,jobs:n})})}),(0,_.jsxs)("div",{className:"flex flex-col space-y-3 w-full justify-center",children:[(0,_.jsxs)("button",{onClick:ie,"data-tour":"hourly-rate",className:"w-full px-3 py-2.5 bg-lemon-yellow dark:bg-lemon-yellow-dark text-dark-navy dark:text-gray-900 rounded-full text-base font-medium shadow-md dark:shadow-lg hover:bg-lemon-yellow dark:hover:bg-lemon-yellow focus:outline-none focus:ring-2 focus:ring-lemon-yellow dark:focus:ring-lemon-yellow-dark focus:ring-opacity-50 transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center space-x-2",children:[(0,_.jsx)(p.q,{className:"w-4 h-4"}),(0,_.jsx)("span",{children:"\uc2dc\uae09 \uc124\uc815"})]}),(0,_.jsxs)("button",{onClick:()=>{v(o),f(!0),W(!0)},"data-tour":"monthly-report",className:"w-full px-3 py-2.5 bg-mint-green dark:bg-mint-green-dark text-white rounded-full text-base font-medium shadow-md dark:shadow-lg hover:bg-mint-green dark:hover:bg-mint-green focus:outline-none focus:ring-2 focus:ring-mint-green dark:focus:ring-mint-green-dark focus:ring-opacity-50 transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center space-x-2",children:[(0,_.jsx)(p.i,{className:"w-4 h-4"}),(0,_.jsx)("span",{children:"\uc6d4\uae09 \ud655\uc778"})]}),(0,_.jsxs)("button",{onClick:()=>R(!0),className:"w-full px-3 py-2.5 bg-gradient-to-r from-purple-500 to-purple-600 dark:from-purple-600 dark:to-purple-700 text-white rounded-full text-base font-medium shadow-md dark:shadow-lg hover:shadow-lg dark:hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-600 focus:ring-opacity-50 transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center space-x-2",children:[(0,_.jsx)(p.g,{className:"w-4 h-4"}),(0,_.jsx)("span",{children:"\ud1b5\uacc4 \ubd84\uc11d"})]}),(0,_.jsxs)("button",{onClick:()=>{P(!0)},className:"w-full px-3 py-2.5 bg-gradient-to-r from-mint-green to-emerald-500 dark:from-mint-green-dark dark:to-emerald-600 text-white rounded-full text-base font-medium shadow-md dark:shadow-lg hover:shadow-lg dark:hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-mint-green dark:focus:ring-mint-green-dark focus:ring-opacity-50 transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center space-x-2",children:[(0,_.jsx)(p.E,{className:"w-4 h-4"}),(0,_.jsx)("span",{children:"\uac00\uc774\ub4dc"})]})]}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(M,{selectedDate:m,isOpen:c,onClose:()=>{u(!1),ae()},session:r,jobs:n})}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(E,{selectedMonth:x,isOpen:g,onClose:()=>{f(!1)},session:r,jobs:n})}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(L,{isOpen:z,onClose:()=>R(!1),workRecords:l,jobs:n,session:r})}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(C,{isOpen:k,onClose:()=>{j(!1)},manualContent:"1. \uc9c1\uc5c5 \uc124\uc815:\n\ud584\ubc84\uac70 \uba54\ub274(\u2630) > '\uc9c1\uc5c5 \uad00\ub9ac'\uc5d0\uc11c \ub098\uc758 \uc9c1\uc5c5\uc744 \ucd94\uac00\ud558\uc138\uc694.\n\n2. \uc2dc\uae09 \uc124\uc815:\n'\uc2dc\uae09 \uc124\uc815' \ubc84\ud2bc\uc744 \ub20c\ub7ec \uc9c1\uc5c5\ubcc4 \uc2dc\uae09\uacfc \uc801\uc6a9 \uc2dc\uc791\uc77c\uc744 \uc124\uc815\ud558\uc138\uc694.\n\n3. \uadfc\ubb34 \uae30\ub85d:\n\ub2ec\ub825\uc5d0\uc11c \ub0a0\uc9dc\ub97c \uc120\ud0dd\ud558\uc5ec \uadfc\ubb34 \uae30\ub85d\uc744 \ucd94\uac00\ud558\uace0 \uad00\ub9ac\ud558\uc138\uc694.\n\n4. \uc6d4\uae09 \ud655\uc778:\n'\uc6d4\uae09 \ud655\uc778' \ubc84\ud2bc\uc744 \ub20c\ub7ec \uc6d4\ubcc4 \uadfc\ubb34 \ubcf4\uace0\uc11c\ub97c \ud655\uc778\ud558\uc138\uc694."})}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(Y,{isOpen:H,onClose:()=>{P(!1)},userProgress:se,onStartTour:e=>{if("string"===typeof e){switch(e){case"setup-job":default:break;case"set-hourly-rate":ie();break;case"first-record":h(new Date),K(!0);break;case"check-report":v(new Date),f(!0),W(!0)}P(!1)}else P(!1),q(!0),U(0)}})}),(0,_.jsx)(a.Suspense,{fallback:null,children:Z&&(0,_.jsx)(T,{selectedDate:m,isOpen:Z,onClose:()=>K(!1),session:r,jobs:n,prefill:Q})}),(0,_.jsx)(S,{context:se.hasJobs?se.hasHourlyRate?se.hasRecords?se.weeklyHours>=15?"weekly-allowance-eligible":(new Date).getDate()>25?"monthly-summary":null:"empty-calendar":"no-hourly-rate":"no-jobs",userProgress:se,onAction:e=>{switch(e){case"add-today":h(new Date),K(!0);break;case"open-job-management":default:break;case"open-hourly-rate":ie();break;case"open-monthly-report":v(new Date),f(!0),W(!0)}}}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(D,{isActive:A,currentStep:B,onStepChange:e=>{U(e)},onComplete:()=>{q(!1),U(0),P(!0)},onSkip:()=>{q(!1),U(0)}})})]})},P=e=>{var t,r;let{session:n,onLogout:o,username:s,onOpenJobManagementModal:i,deferredPrompt:l,onInstallPWA:d,forceOpen:c}=e;const[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),f=(0,a.useRef)(null);(0,a.useEffect)(()=>{c&&m(!0)},[c]),(0,a.useEffect)(()=>{const e=localStorage.getItem("theme");if(e){const t="dark"===e;g(t),t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches;g(e),e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}const t=window.matchMedia("(prefers-color-scheme: dark)"),r=e=>{localStorage.getItem("theme")||(e.matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),g(e.matches))};t.addEventListener("change",r);const a=e=>{f.current&&!f.current.contains(e.target)&&m(!1)};return u?document.addEventListener("mousedown",a):document.removeEventListener("mousedown",a),()=>{t.removeEventListener("change",r),document.removeEventListener("mousedown",a)}},[u]);const x=null===n||void 0===n||null===(t=n.user)||void 0===t||null===(r=t.user_metadata)||void 0===r?void 0:r.avatar_url;return(0,_.jsxs)("div",{className:"relative",ref:f,children:[(0,_.jsx)("button",{onClick:()=>m(!u),"data-tour":"hamburger-menu",className:"p-2 rounded-md text-dark-navy dark:text-white hover:bg-gray-200 dark:hover:bg-charcoal-gray focus:outline-none focus:ring-2 focus:ring-mint-green transition-all duration-200 ease-in-out",children:(0,_.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,_.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),u&&(0,_.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-cream-white dark:bg-charcoal-gray rounded-md shadow-lg py-1 z-layer-dropdown transition-all duration-300 ease-out transform origin-top-right scale-100",children:[n&&x&&(0,_.jsxs)("div",{className:"p-4 flex flex-col items-center border-b border-gray-200 dark:border-gray-700",children:[(0,_.jsx)("img",{src:x,alt:"User Profile",className:"w-16 h-16 rounded-full mb-2 border-2 border-mint-green"}),(0,_.jsx)("p",{className:"text-sm font-semibold text-dark-navy dark:text-white",children:s||n.user.email})]}),(0,_.jsx)("button",{onClick:()=>{const e=!h;g(e),e?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},className:"block w-full text-left px-4 py-2 text-dark-navy dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:h?(0,_.jsx)(p.D,{}):(0,_.jsx)(p.v,{})}),(0,_.jsx)("button",{onClick:()=>{m(!1),i()},"data-tour":"job-management",className:"block w-full text-left px-4 py-2 text-dark-navy dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:"\uc9c1\uc5c5 \uad00\ub9ac"}),(0,_.jsx)("button",{onClick:()=>{var e;const t=encodeURIComponent("[\uc2dc\uae09\uc774\uc694] \ud53c\ub4dc\ubc31"),r=encodeURIComponent("\uc548\ub155\ud558\uc138\uc694, \uc2dc\uae09\uc774\uc694 \uc571\uc5d0 \ub300\ud55c \ud53c\ub4dc\ubc31\uc785\ub2c8\ub2e4.\n\n\uc0ac\uc6a9\uc790: ".concat(s||(null===n||void 0===n||null===(e=n.user)||void 0===e?void 0:e.email)||"\uc54c \uc218 \uc5c6\uc74c","\n\n[\uc5ec\uae30\uc5d0 \ud53c\ub4dc\ubc31 \ub0b4\uc6a9\uc744 \uc791\uc131\ud574\uc8fc\uc138\uc694]\n\n"));window.location.href="mailto:devtestudinidae@gmail.com?subject=".concat(t,"&body=").concat(r),m(!1)},className:"block w-full text-left px-4 py-2 text-dark-navy dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:"\ud53c\ub4dc\ubc31 \ubcf4\ub0b4\uae30"}),(0,_.jsx)("button",{onClick:async()=>{try{if(!n)return;window.dispatchEvent(new CustomEvent("export-csv")),m(!1)}catch(e){}},className:"block w-full text-left px-4 py-2 text-dark-navy dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:"CSV \ub0b4\ubcf4\ub0b4\uae30"}),l&&(0,_.jsx)("button",{onClick:()=>{m(!1),d()},className:"block w-full text-left px-4 py-2 text-dark-navy dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:"\ud648 \ud654\uba74\uc5d0 \ucd94\uac00"}),(0,_.jsx)("button",{onClick:()=>{m(!1),o()},className:"block w-full text-left px-4 py-2 text-dark-navy dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:"\ub85c\uadf8\uc544\uc6c3"})]})]})};var z=r(253),R=r(9994);const A=(0,a.lazy)(()=>r.e(751).then(r.bind(r,7751))),q=(0,a.lazy)(()=>r.e(421).then(r.bind(r,421))),B=()=>{const[e,t]=(0,a.useState)(!1),[r,n]=(0,a.useState)(!1),[o,i]=(0,a.useState)(null),[l,d]=(0,a.useState)(null),[c,u]=(0,a.useState)([]),[m,h]=(0,a.useState)(null),g=(0,z.b)(),f=(0,a.useCallback)(async()=>{if(!o)return;const{user:e}=o,{data:t,error:r}=await w.a.from("profiles").select("username").eq("user_id",e.id).single();if(r&&"PGRST116"!==r.code)console.error("Error fetching profile:",r);else if(t)d(t.username);else{const{error:t}=await w.a.from("profiles").insert([{user_id:e.id,username:e.email.split("@")[0]}]);t?console.error("Error inserting new profile:",t):d(e.email.split("@")[0])}},[o]),x=(0,a.useCallback)(async()=>{if(!o)return;const{data:e,error:t}=await w.a.from("jobs").select("id").eq("user_id",o.user.id);if(t)console.error("Error checking jobs:",t);else if(0===e.length){const{data:e,error:t}=await w.a.from("jobs").insert([{user_id:o.user.id,job_name:"\uae30\ubcf8 \uc9c1\uc5c5"}]).select().single();if(t)return void console.error("Error creating default job:",t);const r=e.id,{error:a}=await w.a.from("hourly_rate_history").update({job_id:r}).is("job_id",null).eq("user_id",o.user.id);a&&console.error("Error migrating hourly_rate_history:",a);const{error:n}=await w.a.from("work_records").update({job_id:r}).is("job_id",null).eq("user_id",o.user.id);n&&console.error("Error migrating work_records:",n)}},[o]),b=(0,a.useCallback)(async()=>{if(!o)return;const{data:e,error:t}=await w.a.from("jobs").select("id, job_name, description, payday, color, break_time_enabled, break_time_paid, break_time_policies, weekly_allowance_enabled, weekly_allowance_min_hours").eq("user_id",o.user.id).eq("is_deleted",!1).order("created_at",{ascending:!0});t?console.error("Error fetching jobs:",t):(u(e),e&&e.length>0&&((0,v.h)(e),console.log("\ud83d\udcbe \ud734\uac8c\uc2dc\uac04 \uce90\uc2dc \uc608\uc5f4 \uc644\ub8cc:",e.length,"\uac1c \uc9c1\uc5c5")))},[o]);(0,a.useEffect)(()=>{w.a.auth.getSession().then(e=>{let{data:{session:t}}=e;i(t)});const{data:{subscription:e}}=w.a.auth.onAuthStateChange((e,t)=>{i(t)});return window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),h(e)}),()=>e.unsubscribe()},[]),(0,a.useEffect)(()=>{const e=async()=>{if(!o)return;const e=s()().startOf("month").format("YYYY-MM-DD"),t=s()().endOf("month").format("YYYY-MM-DD"),{data:r,error:a}=await w.a.from("work_records").select("id,date,start_time,end_time,daily_wage,meal_allowance,notes,wage_type,job_id,jobs(job_name,break_time_enabled,break_time_paid,break_time_policies)").eq("user_id",o.user.id).gte("date",e).lte("date",t).order("date",{ascending:!0});if(a)return;const n=(r||[]).filter(e=>"hourly"===e.wage_type).map(e=>e.id),i=new Map;if(n.length>0)for(const s of n){const e=r.find(e=>e.id===s);if(!e||!e.date)continue;const{data:t}=await w.a.from("hourly_rate_history").select("hourly_rate").eq("user_id",o.user.id).eq("job_id",e.job_id).lte("effective_date",e.date).order("effective_date",{ascending:!1}).limit(1);t&&t.length>0&&i.set(s,t[0].hourly_rate)}const l=[["date","job_name","start_time","end_time","calculated_wage","stored_wage","meal_allowance","break_minutes","notes"],...(r||[]).map(e=>{var t;let r=e.daily_wage||0,a=0;if("hourly"===e.wage_type&&e.start_time&&e.end_time&&e.jobs){const t=i.get(e.id)||0;if(t>0){const n=(0,v.c)(e.start_time,e.end_time,e.jobs);a=n.breakTime.breakMinutes;let o=n.workHours;n.breakTime.isPaid&&(o=n.totalHours),r=Math.round(o*t)+(e.meal_allowance||0)}}return[e.date,(null===(t=e.jobs)||void 0===t?void 0:t.job_name)||"",e.start_time||"",e.end_time||"",r.toString(),(e.daily_wage||0).toString(),(e.meal_allowance||0).toString(),a.toString(),(e.notes||"").replaceAll("\n"," ")]})].map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(",")).join("\n"),d=new Blob(["\ufeff"+l],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(d),u=document.createElement("a");u.href=c,u.download="work_records_".concat(s()().format("YYYYMM"),".csv"),document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(c)};return window.addEventListener("export-csv",e),()=>window.removeEventListener("export-csv",e)},[o]),(0,a.useEffect)(()=>{o&&(f(),x(),b())},[o,f,x,b]);return(0,_.jsxs)(_.Fragment,{children:[o&&(0,_.jsx)("header",{className:"fixed top-0 left-0 right-0 z-layer-nav bg-transparent pointer-events-none",children:(0,_.jsxs)("div",{className:"flex justify-between items-center px-3 py-4 pointer-events-auto max-w-[390px] w-full mx-auto",children:[(0,_.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer hover:scale-105 transition-transform duration-200",onClick:()=>{window.location.reload()},children:[(0,_.jsx)("img",{src:"/logo192.png",alt:"\uc2dc\uae09\uc774\uc694 \ub85c\uace0",className:"w-8 h-8"}),(0,_.jsx)("h1",{className:"text-dark-navy dark:text-white text-xl font-bold",children:"\uc2dc\uae09\uc774\uc694"})]}),(0,_.jsx)(P,{session:o,onLogout:async()=>{try{g("\ub85c\uadf8\uc544\uc6c3 \uc911...","info"),i(null),d(null),u([]);const{error:e}=await w.a.auth.signOut();e&&console.warn("Supabase logout warning:",e.message),localStorage.removeItem("supabase.auth.token"),localStorage.removeItem("sb-llvtylnqjemgsnvbfxch-auth-token"),g("\uc548\uc804\ud558\uac8c \ub85c\uadf8\uc544\uc6c3\ub418\uc5c8\uc2b5\ub2c8\ub2e4","success"),setTimeout(()=>{window.location.reload()},1e3)}catch(e){console.warn("Logout process error:",e.message),g("\ub85c\uadf8\uc544\uc6c3 \uc644\ub8cc","success"),i(null),d(null),u([]),setTimeout(()=>{window.location.reload()},1e3)}},username:l,onOpenJobManagementModal:()=>n(!0),deferredPrompt:m,onInstallPWA:async()=>{m&&(m.prompt(),await m.userChoice,h(null))}})]})}),(0,_.jsx)("div",{className:"App bg-gradient-to-b from-cream-white to-gray-50 dark:from-deep-navy dark:to-charcoal-gray min-h-screen flex flex-col items-center justify-center px-4 py-6 pt-16 max-w-[390px] w-full mx-auto overflow-hidden",children:o?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(H,{onOpenHourlyRateModal:()=>t(!0),session:o,jobs:c}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(A,{isOpen:e,onClose:()=>{t(!1),b()},onSaveHourlyRate:async(e,t,r)=>{if(!o)return;const{error:a}=await w.a.from("hourly_rate_history").delete().eq("user_id",o.user.id).eq("job_id",e).eq("effective_date",r);a&&console.error("Error deleting duplicate rate record:",a);const n=s()(r).subtract(1,"day").format("YYYY-MM-DD"),{data:i,error:l}=await w.a.from("hourly_rate_history").select("id").eq("user_id",o.user.id).eq("job_id",e).lte("effective_date",n).is("end_date",null);if(l)console.error("Error fetching previous hourly rates:",l);else if(i.length>0)for(const o of i){const{error:e}=await w.a.from("hourly_rate_history").update({end_date:n}).eq("id",o.id);e&&console.error("Error updating previous rate end_date:",e)}const{error:d}=await w.a.from("hourly_rate_history").insert([{hourly_rate:t,user_id:o.user.id,job_id:e,effective_date:r,end_date:null}]);if(d)console.error("Error inserting new hourly rate:",d),g("\uc800\uc7a5\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error");else{g("\uc2dc\uae09\uc744 \uc800\uc7a5\ud588\uc5b4\uc694","success"),b();try{window.dispatchEvent(new Event("work-records-changed")),console.log("\ud83d\udcbe \uc2dc\uae09 \ubcc0\uacbd\uc73c\ub85c \uc778\ud55c \uae09\uc5ec \uce90\uc2dc \ubb34\ud6a8\ud654 \uc644\ub8cc")}catch(c){}}},session:o,jobs:c,fetchJobs:b})}),(0,_.jsx)(a.Suspense,{fallback:null,children:(0,_.jsx)(q,{isOpen:r,onClose:()=>n(!1),session:o,jobs:c,fetchJobs:b})})]}):(0,_.jsxs)("div",{className:"w-full max-w-sm mx-auto",children:[(0,_.jsxs)("div",{className:"text-center mb-12 animate-fade-in-up",children:[(0,_.jsxs)("div",{className:"relative mb-8",children:[(0,_.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-mint-green/20 to-brand-purple/20 rounded-full blur-xl animate-pulse-slow"}),(0,_.jsx)("img",{src:"/logo192.png",alt:"\uc2dc\uae09\uc774\uc694 \ub85c\uace0",className:"w-20 h-20 mx-auto relative animate-bounce-gentle drop-shadow-lg"})]}),(0,_.jsx)("h1",{className:"text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-mint-green to-brand-purple mb-4 animate-shimmer",children:"\uc2dc\uae09\uc774\uc694"}),(0,_.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 text-lg font-medium leading-relaxed",children:["\ub0b4 \uc2dc\uae09, \uadfc\ubb34\uae30\ub85d, \uc218\uc785\uc744",(0,_.jsx)("br",{}),(0,_.jsx)("span",{className:"text-mint-green font-bold",children:"\ud55c\ub208\uc5d0 \uad00\ub9ac\ud558\uc138\uc694"})]})]}),(0,_.jsxs)("div",{className:"space-y-4 mb-12",children:[(0,_.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 transform hover:scale-[1.02] transition-all duration-300 animate-slide-in-left",children:(0,_.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,_.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-mint-green to-green-400 rounded-xl flex items-center justify-center",children:(0,_.jsx)("span",{className:"text-white text-xl",children:"\ud83d\udcb0"})}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"font-bold text-gray-900 dark:text-white text-lg",children:"\uc2a4\ub9c8\ud2b8 \uae09\uc5ec \uacc4\uc0b0"}),(0,_.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"\uc2dc\uae09\ubd80\ud130 \uc6d4\uae09\uae4c\uc9c0 \uc790\ub3d9 \uacc4\uc0b0"})]})]})}),(0,_.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 transform hover:scale-[1.02] transition-all duration-300 animate-slide-in-right",style:{animationDelay:"0.2s"},children:(0,_.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,_.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:(0,_.jsx)("span",{className:"text-white text-xl",children:"\ud83d\udcca"})}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"font-bold text-gray-900 dark:text-white text-lg",children:"\uadfc\ubb34 \uae30\ub85d \uad00\ub9ac"}),(0,_.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"\ucd9c\ud1f4\uadfc \uc2dc\uac04\uc744 \uc27d\uace0 \ube60\ub974\uac8c"})]})]})}),(0,_.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 transform hover:scale-[1.02] transition-all duration-300 animate-slide-in-left",style:{animationDelay:"0.4s"},children:(0,_.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,_.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl flex items-center justify-center",children:(0,_.jsx)("span",{className:"text-white text-xl",children:"\ud83d\udcc8"})}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{className:"font-bold text-gray-900 dark:text-white text-lg",children:"\uc218\uc785 \uc778\uc0ac\uc774\ud2b8"}),(0,_.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"\uc6d4\ubcc4 \ud1b5\uacc4\uc640 \ud2b8\ub80c\ub4dc \ubd84\uc11d"})]})]})})]}),(0,_.jsxs)("div",{className:"space-y-4 animate-slide-in-up",style:{animationDelay:"0.6s"},children:[(0,_.jsxs)("button",{onClick:async()=>{const{error:e}=await w.a.auth.signInWithOAuth({provider:"google"});e&&console.error("Error logging in with Google:",e.message)},className:"w-full bg-gradient-to-r from-mint-green to-green-500 text-white py-4 px-6 rounded-2xl text-lg font-bold shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200 flex items-center justify-center space-x-3 group",children:[(0,_.jsx)("span",{className:"text-2xl group-hover:scale-110 transition-transform duration-200",children:"\ud83d\ude80"}),(0,_.jsx)("span",{children:"Google\ub85c \uc2dc\uc791\ud558\uae30"})]}),(0,_.jsx)("p",{className:"text-center text-gray-400 dark:text-gray-500 text-sm",children:"\ub85c\uadf8\uc778\ud558\uace0 \ub098\ub9cc\uc758 \uae09\uc5ec \ub300\uc2dc\ubcf4\ub4dc\ub97c \ub9cc\ub4e4\uc5b4\ubcf4\uc138\uc694"})]})]})})]})};const U=function(){return(0,_.jsx)(z.a,{children:(0,_.jsx)(R.a,{children:(0,_.jsx)(B,{})})})},J=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function W(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const r=e.installing;null!=r&&(r.onstatechange=()=>{"installed"===r.state&&(navigator.serviceWorker.controller?(console.log("\ud83d\ude80 \uc0c8 \uc5c5\ub370\uc774\ud2b8\uac00 \uc788\uc2b5\ub2c8\ub2e4! \uc0c8\ub85c\uace0\uce68\ud558\uc5ec \ucd5c\uc2e0 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud558\uc138\uc694."),t&&t.onUpdate?t.onUpdate(e):window.confirm("\uc0c8 \uc5c5\ub370\uc774\ud2b8\uac00 \uc788\uc2b5\ub2c8\ub2e4. \uc9c0\uae08 \uc0c8\ub85c\uace0\uce68\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&window.location.reload()):(console.log("\ud83d\udcbe \uc2dc\uae09\uc774\uc694\uac00 \uc624\ud504\ub77c\uc778\uc5d0\uc11c\ub3c4 \uc0ac\uc6a9 \uac00\ub2a5\ud569\ub2c8\ub2e4."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}const F=localStorage.getItem("theme"),G=window.matchMedia("(prefers-color-scheme: dark)").matches;"dark"===F||!F&&G?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),n.render((0,_.jsx)(U,{}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat("","/service-worker.js");J?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(r=>{const a=r.headers.get("content-type");404===r.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):W(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{})):W(t,e)})}}({onUpdate:e=>{const t=e.waiting;if(t){const e=()=>{const t=document.createElement("div");t.innerHTML='\n          <div id="update-prompt" style="\n            position: fixed; \n            top: 0; \n            left: 0; \n            width: 100%; \n            height: 100%; \n            background: rgba(0, 0, 0, 0.5); \n            z-index: 10000; \n            display: flex; \n            align-items: center; \n            justify-content: center;\n            animation: fadeIn 0.3s ease-out;\n          ">\n            <div style="\n              background: white; \n              border-radius: 20px; \n              padding: 24px; \n              max-width: 320px; \n              margin: 20px;\n              box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);\n              font-family: \'Pretendard Variable\', sans-serif;\n              text-align: center;\n            ">\n              <div style="font-size: 48px; margin-bottom: 16px;">\ud83d\ude80</div>\n              <h3 style="margin: 0 0 12px 0; font-size: 18px; font-weight: 700; color: #1F2937;">\n                \uc0c8 \uc5c5\ub370\uc774\ud2b8\uac00 \uc788\uc2b5\ub2c8\ub2e4!\n              </h3>\n              <p style="margin: 0 0 20px 0; font-size: 14px; color: #6B7280; line-height: 1.5;">\n                \uc2dc\uae09\uc774\uc694\uc758 \uc0c8\ub85c\uc6b4 \uae30\ub2a5\uacfc \uac1c\uc120\uc0ac\ud56d\uc744<br>\uc9c0\uae08 \ubc14\ub85c \uc0ac\uc6a9\ud574\ubcf4\uc138\uc694.\n              </p>\n              <div style="display: flex; gap: 8px;">\n                <button id="update-later" style="\n                  flex: 1; \n                  padding: 12px; \n                  border: 1px solid #E5E7EB; \n                  border-radius: 12px; \n                  background: white; \n                  color: #6B7280; \n                  font-size: 14px; \n                  font-weight: 600; \n                  cursor: pointer;\n                ">\ub098\uc911\uc5d0</button>\n                <button id="update-now" style="\n                  flex: 1; \n                  padding: 12px; \n                  border: none; \n                  border-radius: 12px; \n                  background: linear-gradient(135deg, #10B981, #059669); \n                  color: white; \n                  font-size: 14px; \n                  font-weight: 600; \n                  cursor: pointer;\n                ">\uc9c0\uae08 \uc5c5\ub370\uc774\ud2b8</button>\n              </div>\n            </div>\n          </div>\n          <style>\n            @keyframes fadeIn {\n              from { opacity: 0; }\n              to { opacity: 1; }\n            }\n          </style>\n        ',document.body.appendChild(t),document.getElementById("update-now").addEventListener("click",()=>{document.body.removeChild(t),r()}),document.getElementById("update-later").addEventListener("click",()=>{document.body.removeChild(t),setTimeout(e,6e5)})},r=()=>{t.postMessage({type:"SKIP_WAITING"});const e=document.createElement("div");e.innerHTML="\n          <div style=\"\n            position: fixed; \n            top: 20px; \n            left: 50%; \n            transform: translateX(-50%); \n            background: linear-gradient(135deg, #10B981, #059669); \n            color: white; \n            padding: 16px 24px; \n            border-radius: 16px; \n            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);\n            z-index: 10001;\n            font-family: 'Pretendard Variable', sans-serif;\n            font-weight: 600;\n            animation: slideInDown 0.5s ease-out;\n          \">\n            \ud83d\udd04 \uc5c5\ub370\uc774\ud2b8 \uc911...\n          </div>\n          <style>\n            @keyframes slideInDown {\n              from { transform: translateX(-50%) translateY(-100%); opacity: 0; }\n              to { transform: translateX(-50%) translateY(0); opacity: 1; }\n            }\n          </style>\n        ",document.body.appendChild(e),t.addEventListener("statechange",e=>{"activated"===e.target.state&&setTimeout(()=>{window.location.reload()},1e3)})};e()}},onSuccess:e=>{console.log("\ud83d\udcbe \uc2dc\uae09\uc774\uc694 PWA\uac00 \uc131\uacf5\uc801\uc73c\ub85c \uc124\uce58\ub418\uc5c8\uc2b5\ub2c8\ub2e4!",e),setInterval(()=>{e.update()},36e5)}})},9994:(e,t,r)=>{r.d(t,{a:()=>i,b:()=>l});var a=r(5043),n=r(579);const o=e=>{let{message:t,onConfirm:r,onCancel:o}=e;const[s,i]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t?(i(!0),setTimeout(()=>d(!0),10),document.body.classList.add("modal-open")):(d(!1),setTimeout(()=>i(!1),300),document.body.classList.remove("modal-open"))},[t]),(0,a.useEffect)(()=>()=>{document.body.classList.remove("modal-open")},[]),s?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center transition-opacity duration-300 ease-out ".concat(l?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"," z-layer-modal"),children:(0,n.jsxs)("div",{className:"bg-cream-white dark:bg-gray-900 rounded-lg shadow-lg dark:shadow-2xl dark:shadow-black/50 p-6 w-full max-w-xs mx-4 text-center transform transition-all duration-300 ease-out ".concat(l?"translate-y-0":"translate-y-10"),children:[(0,n.jsx)("p",{className:"text-dark-navy dark:text-white text-lg mb-6",children:t}),(0,n.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,n.jsx)("button",{onClick:o,className:"px-5 py-2 bg-medium-gray text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-medium-gray focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\uc544\ub2c8\uc694"}),(0,n.jsx)("button",{onClick:r,className:"px-5 py-2 bg-mint-green text-white rounded-lg hover:bg-mint-green-dark focus:outline-none focus:ring-2 focus:ring-mint-green focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\ub124"})]})]})}):null},s=(0,a.createContext)(null),i=e=>{let{children:t}=e;const[r,i]=(0,a.useState)(null),l=(0,a.useCallback)((e,t,r)=>{i({message:e,onConfirm:()=>{t(),i(null)},onCancel:()=>{r&&r(),i(null)}})},[]);return(0,n.jsxs)(s.Provider,{value:l,children:[t,r&&(0,n.jsx)(o,{message:r.message,onConfirm:r.onConfirm,onCancel:r.onCancel})]})},l=()=>{const e=(0,a.useContext)(s);if(!e)throw new Error("useConfirm must be used within a ConfirmProvider");return e}}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,r),o.exports}r.m=e,(()=>{var e=[];r.O=(t,a,n,o)=>{if(!a){var s=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],o=e[c][2];for(var i=!0,l=0;l<a.length;l++)(!1&o||s>=o)&&Object.keys(r.O).every(e=>r.O[e](a[l]))?a.splice(l--,1):(i=!1,o<s&&(s=o));if(i){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[a,n,o]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var o=Object.create(null);r.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var i=2&n&&a;("object"==typeof i||"function"==typeof i)&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach(e=>s[e]=()=>a[e]);return s.default=()=>a,r.d(o,s),o}})(),r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,a)=>(r.f[a](e,t),t),[])),r.u=e=>"static/js/"+e+"."+{16:"c98da26a",33:"3b718f38",39:"0ad4e7d7",200:"8120c87b",421:"8d21c8ae",596:"bb97f79f",685:"d033259b",751:"e6a851ce",887:"3d2ec850",908:"0a57e227",975:"d273e0ca"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="szwagecalc:";r.l=(a,n,o,s)=>{if(e[a])e[a].push(n);else{var i,l;if(void 0!==o)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+o){i=u;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,r.nc&&i.setAttribute("nonce",r.nc),i.setAttribute("data-webpack",t+o),i.src=a),e[a]=[n];var m=(t,r)=>{i.onerror=i.onload=null,clearTimeout(h);var n=e[a];if(delete e[a],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach(e=>e(r)),t)return t(r)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),l&&document.head.appendChild(i)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/",(()=>{var e={792:0};r.f.j=(t,a)=>{var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)a.push(n[2]);else{var o=new Promise((r,a)=>n=e[t]=[r,a]);a.push(n[2]=o);var s=r.p+r.u(t),i=new Error;r.l(s,a=>{if(r.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,n[1](i)}},"chunk-"+t,t)}},r.O.j=t=>0===e[t];var t=(t,a)=>{var n,o,s=a[0],i=a[1],l=a[2],d=0;if(s.some(t=>0!==e[t])){for(n in i)r.o(i,n)&&(r.m[n]=i[n]);if(l)var c=l(r)}for(t&&t(a);d<s.length;d++)o=s[d],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},a=self.webpackChunkszwagecalc=self.webpackChunkszwagecalc||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=r.O(void 0,[644,707,173,96],()=>r(7240));a=r.O(a)})();