"use strict";(self.webpackChunkszwagecalc=self.webpackChunkszwagecalc||[]).push([[887],{4429:(e,t,s)=>{s.d(t,{a:()=>k,b:()=>f,c:()=>j,d:()=>y,e:()=>w,f:()=>b});var a=s(9379),r=s(446),n=s.n(r),l=s(6865),o=s.n(l),c=s(7140),d=s.n(c),i=s(4462),x=s.n(i),u=s(8933),m=s.n(u),h=s(6632);n().extend(o()),n().extend(d()),n().extend(x()),n().extend(m());const g=new Map;function f(e,t){if(null===t||void 0===t||!t.weekly_allowance_enabled)return{eligible:!1,totalWorkHours:0,averageHourlyRate:0,allowanceAmount:0,workDays:0,reason:"\uc8fc\ud734\uc218\ub2f9 \uc801\uc6a9 \uc548\ud568"};const s=t.weekly_allowance_min_hours||15;let a=0,r=0,n=0,l=!1;const o=new Set;for(const x of e){if(x.job_id!==t.id||"hourly"!==x.wage_type)continue;if(x.is_unexcused_absence&&(l=!0),!x.start_time||!x.end_time)continue;a+=(0,h.c)(x.start_time,x.end_time,x.jobs||t).workHours,r+=(x.daily_wage||0)-(x.meal_allowance||0),o.add(x.date)}if(n=o.size,l)return{eligible:!1,totalWorkHours:Math.round(100*a)/100,averageHourlyRate:0,allowanceAmount:0,workDays:n,hasUnexcusedAbsence:!0,reason:"\ubb34\ub2e8\uacb0\uadfc\uc73c\ub85c \uc778\ud55c \uc8fc\ud734\uc218\ub2f9 \uc9c0\uae09 \ubd88\uac00"};if(a<s)return{eligible:!1,totalWorkHours:Math.round(100*a)/100,averageHourlyRate:0,allowanceAmount:0,workDays:n,hasUnexcusedAbsence:!1,reason:"\uc8fc\uac04 \uadfc\ubb34\uc2dc\uac04 \ubd80\uc871 (".concat(a.toFixed(1),"\uc2dc\uac04 < ").concat(s,"\uc2dc\uac04)")};if(0===n)return{eligible:!1,totalWorkHours:Math.round(100*a)/100,averageHourlyRate:0,allowanceAmount:0,workDays:0,hasUnexcusedAbsence:!1,reason:"\ud574\ub2f9 \uc9c1\uc5c5 \uadfc\ubb34\uc77c \uc5c6\uc74c"};const c=r>0?Math.round(r/a):0,d=a/n,i=Math.round(d*c);return{eligible:!0,totalWorkHours:Math.round(100*a)/100,averageHourlyRate:c,allowanceAmount:i,workDays:n,avgDailyHours:Math.round(100*d)/100,hasUnexcusedAbsence:!1,reason:"\uc8fc\ud734\uc218\ub2f9 \uc9c0\uae09 \ub300\uc0c1"}}function b(e,t){const s=n()(t),a=s.startOf("isoWeek"),r=s.endOf("isoWeek");return e.filter(e=>{const t=n()(e.date);return t.isSameOrAfter(a,"day")&&t.isSameOrBefore(r,"day")})}function k(e,t,s){const a=n()(s),r=a.startOf("month"),l=a.endOf("month"),o=[];let c=r.startOf("isoWeek");for(;c.isBefore(l)||c.isSame(l,"week");)o.push(c),c=c.add(1,"week");let d=0,i=0;const x=new Map;for(const n of o){const s=b(e,n);for(const e of t){if(!e.weekly_allowance_enabled)continue;const t=f(s,e);if(t.eligible&&t.allowanceAmount>0){d+=t.allowanceAmount,i++,x.has(e.id)||x.set(e.id,{jobName:e.job_name,jobColor:e.color,totalAmount:0,weekCount:0});const s=x.get(e.id);s.totalAmount+=t.allowanceAmount,s.weekCount++}}}return{totalAllowance:d,eligibleWeeks:i,totalWeeks:o.length,jobAllowances:Array.from(x.values())}}function w(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date;const r=n()(s),l=f(b(e,r),t),o=r.startOf("isoWeek"),c=r.endOf("isoWeek"),d=c.diff(o,"day")+1,i=r.diff(o,"day")+1,x=(null===t||void 0===t?void 0:t.weekly_allowance_min_hours)||15,u=Math.min(100,l.totalWorkHours/x*100);return(0,a.a)((0,a.a)({},l),{},{weekStart:o.format("YYYY-MM-DD"),weekEnd:c.format("YYYY-MM-DD"),daysInWeek:d,daysPassed:i,progressPercent:Math.round(u),hoursNeeded:Math.max(0,x-l.totalWorkHours),isCurrentWeek:!0})}function j(){g.clear()}function y(e){const t=n()(e),s=t.endOf("isoWeek"),a=Math.ceil(t.date()/7);return"".concat(t.format("M\uc6d4")," ").concat(a,"\uc8fc\ucc28 (").concat(t.format("M/D"),"~").concat(s.format("M/D"),")")}},6887:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var a=s(5043),r=s(446),n=s.n(r),l=s(7140),o=s.n(l),c=s(1525),d=s.n(c),i=s(8521),x=s(4429),u=s(579);n().extend(o()),n().extend(d());const m=e=>{let{selectedDate:t,workRecords:s,jobs:r}=e;const[l,o]=(0,a.useState)(!1),c=r.filter(e=>e.weekly_allowance_enabled);if(0===c.length)return null;const d=n()(t),m=d.startOf("month"),h=d.endOf("month"),g=[];let f=m.startOf("isoWeek");for(;f.isBefore(h)||f.isSame(h,"week");){const e=f,t=f.endOf("isoWeek");e.isSameOrBefore(h)&&t.isSameOrAfter(m)&&g.push({start:e,end:t,label:(0,x.d)(e),isCurrentWeek:n()().isBetween(e,t,"day","[]")}),f=f.add(1,"week")}const b=g.reduce((e,t)=>{const a=(0,x.f)(s,t.start);let r=0,n=!1,l=!1,o=!1;return c.forEach(e=>{const t=(0,x.b)(a,e);t.totalWorkHours>0&&(l=!0),t.hasUnexcusedAbsence&&(o=!0),t.eligible&&(n=!0,r+=t.allowanceAmount)}),l&&(e.totalWeeks++,n&&e.eligibleWeeks++,o&&e.unexcusedWeeks++,e.totalAmount+=r),e},{totalAmount:0,eligibleWeeks:0,totalWeeks:0,unexcusedWeeks:0}),k=(()=>{const e=g.find(e=>e.isCurrentWeek);if(!e)return null;const t=(0,x.f)(s,e.start);let a=0,r=!1;return c.forEach(e=>{const s=(0,x.b)(t,e);a+=s.totalWorkHours,s.hasUnexcusedAbsence&&(r=!0)}),{totalHours:a,minHours:15,progress:Math.min(a/15*100,100),hasAbsence:r}})();return(0,u.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow overflow-hidden",children:[(0,u.jsx)("button",{onClick:()=>o(!l),className:"w-full p-4 text-left hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-200",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,u.jsx)(i.q,{className:"w-5 h-5 text-mint-green flex-shrink-0"}),(0,u.jsxs)("span",{className:"text-base font-semibold text-dark-navy dark:text-white",children:[d.format("M\uc6d4")," \uc8fc\ud734\uc218\ub2f9"]})]}),(0,u.jsxs)("div",{className:"space-y-1",children:[(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsxs)("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:["+",b.totalAmount.toLocaleString(),"\uc6d0"]}),b.totalWeeks>0&&(0,u.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["(",b.eligibleWeeks,"/",b.totalWeeks,"\uc8fc \uc9c0\uae09)"]})]}),k&&!k.hasAbsence&&k.totalHours>0&&(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsxs)("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:["                  ",(0,u.jsx)(i.I,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"})]}),(0,u.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\uc774\ubc88 \uc8fc ",k.progress.toFixed(0),"% (",k.totalHours.toFixed(1),"h/",k.minHours,"h)"]}),(0,u.jsx)("div",{className:"flex-1 max-w-20 h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,u.jsx)("div",{className:"h-full transition-all duration-300 ".concat(k.progress>=100?"bg-green-500":"bg-blue-500"),style:{width:"".concat(k.progress,"%")}})})]}),(null===k||void 0===k?void 0:k.hasAbsence)&&(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsxs)("span",{className:"text-xs text-red-500",children:["                  ",(0,u.jsx)(i.b,{className:"w-3 h-3 text-red-500"})]}),(0,u.jsx)("span",{className:"text-xs text-red-600 dark:text-red-400",children:"\uc774\ubc88 \uc8fc \ubb34\ub2e8\uacb0\uadfc\uc73c\ub85c \uc9c0\uae09 \ubd88\uac00"})]})]})]}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:l?"\ub2eb\uae30":"\uc0c1\uc138\ubcf4\uae30"}),l?(0,u.jsx)(i.o,{className:"w-4 h-4 text-gray-400 transition-transform duration-200"}):(0,u.jsx)(i.m,{className:"w-4 h-4 text-gray-400 transition-transform duration-200"})]})]})}),(0,u.jsx)("div",{className:"transition-all duration-300 ease-in-out overflow-hidden ".concat(l?"max-h-96 opacity-100":"max-h-0 opacity-0"),children:(0,u.jsx)("div",{className:"px-4 pb-4 border-t border-gray-100 dark:border-gray-700",children:(0,u.jsx)("div",{className:"space-y-3 mt-3",children:g.map((e,t)=>{const a=(0,x.f)(s,e.start);let r=0,n=!1,l=!1,o=!1;const d=c.map(e=>{const t=(0,x.b)(a,e);return t.totalWorkHours>0&&(o=!0),t.hasUnexcusedAbsence&&(l=!0),t.eligible&&(n=!0,r+=t.allowanceAmount),{job:e,result:t}}).filter(e=>{let{result:t}=e;return t.totalWorkHours>0});return o?(0,u.jsxs)("div",{className:"rounded-lg border p-3 ".concat(e.isCurrentWeek?"border-blue-300 bg-blue-50 dark:border-blue-700 dark:bg-blue-900/20":"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50"),children:[(0,u.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:e.label}),e.isCurrentWeek&&(0,u.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full dark:bg-blue-900/30 dark:text-blue-400",children:"\uc774\ubc88 \uc8fc"})]}),(0,u.jsx)("div",{className:"text-right",children:l?(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsxs)("span",{className:"text-xs",children:["                          ",(0,u.jsx)(i.b,{className:"w-3 h-3 text-red-600 dark:text-red-400"})]}),(0,u.jsx)("span",{className:"text-sm font-semibold text-red-600 dark:text-red-400",children:"\uc9c0\uae09 \ubd88\uac00"})]}):n?(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsxs)("span",{className:"text-xs",children:["                          ",(0,u.jsx)(i.l,{className:"w-3 h-3 text-green-600 dark:text-green-400"})]}),(0,u.jsxs)("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400",children:["+",r.toLocaleString(),"\uc6d0"]})]}):(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsxs)("span",{className:"text-xs",children:["                          ",(0,u.jsx)(i.A,{className:"w-3 h-3 text-orange-600 dark:text-orange-400"})]}),(0,u.jsx)("span",{className:"text-sm text-orange-600 dark:text-orange-400 font-medium",children:"\uc9c4\ud589 \uc911"})]})})]}),d.length>0&&(0,u.jsx)("div",{className:"space-y-1",children:d.map(e=>{let{job:t,result:s}=e;return(0,u.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,u.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,u.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t.color}}),(0,u.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:t.job_name}),(0,u.jsxs)("span",{className:"text-gray-500 dark:text-gray-500",children:[s.totalWorkHours.toFixed(1),"h"]})]}),(0,u.jsx)("div",{className:"text-right",children:s.hasUnexcusedAbsence?(0,u.jsx)("span",{className:"text-red-500",children:"\uc9c0\uae09\ubd88\uac00"}):s.eligible?(0,u.jsxs)("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["+",s.allowanceAmount.toLocaleString(),"\uc6d0"]}):(0,u.jsxs)("span",{className:"text-orange-500",children:[(t.weekly_allowance_min_hours-s.totalWorkHours).toFixed(1),"h \ubd80\uc871"]})})]},t.id)})})]},t):(0,u.jsxs)("div",{className:"flex items-center justify-between py-2 text-gray-400 dark:text-gray-600",children:[(0,u.jsx)("span",{className:"text-sm",children:e.label}),(0,u.jsxs)("span",{className:"text-xs flex items-center gap-1",children:[(0,u.jsx)(i.v,{className:"w-3 h-3"}),"\ub300\uae30 \uc911"]})]},t)})})})})]})}}}]);