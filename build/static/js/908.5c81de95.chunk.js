"use strict";(self.webpackChunkszwagecalc=self.webpackChunkszwagecalc||[]).push([[16,908],{61:(e,t,r)=>{r.d(t,{B:()=>n,j:()=>a});const a=[{id:"brand-purple",name:"\ube0c\ub79c\ub4dc \ud37c\ud50c",value:"var(--accent-primary)",textLight:"var(--accent-text)",textDark:"var(--accent-text)",inactive:"rgba(139, 92, 246, 0.25)"},{id:"success-green",name:"\uc11d\uc138\uc2a4 \uadf8\ub9b0",value:"var(--success-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(34, 197, 94, 0.25)"},{id:"warning-orange",name:"\uc6cc\ub2dd \uc624\ub80c\uc9c0",value:"var(--warning-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(249, 115, 22, 0.25)"},{id:"error-red",name:"\uc5d0\ub7ec \ub808\ub4dc",value:"var(--error-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(239, 68, 68, 0.25)"},{id:"blue",name:"\ube14\ub8e8",value:"#2563EB",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(37, 99, 235, 0.25)"},{id:"fuchsia",name:"\ud4e8\uc2dc\uc544",value:"#C026D3",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(192, 38, 211, 0.25)"},{id:"coffee-brown",name:"\ucee4\ud53c \ube0c\ub77c\uc6b4",value:"#8B5E3C",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(139, 94, 60, 0.25)"}],s=a[0],i=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=a.find(t=>t.value===e);if(r)return t?r.textDark:r.textLight;if(!e)return t?"#FFFFFF":"#1F2937";if(e.startsWith("var("))return"var(--text-inverse)";const s=e.replace("#","");return(.299*parseInt(s.substr(0,2),16)+.587*parseInt(s.substr(2,2),16)+.114*parseInt(s.substr(4,2),16))/255>.5?"#1F2937":"#FFFFFF"},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.color||s.value,o=(l=n,a.find(e=>e.value===l)||s);var l;return t?{backgroundColor:n,color:i(n,r),borderColor:n}:{backgroundColor:o?o.inactive:"rgba(0,0,0,0.1)",color:"var(--text-secondary)",borderColor:o?o.inactive:"rgba(0,0,0,0.1)"}}},3908:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(5043),s=r(446),i=r.n(s),n=r(2521),o=r(6632),l=r(5843),d=r(5016),c=r(9994),m=r(253),u=r(8521),x=r(61),g=r(579);const b=(e,t)=>{if(!e||!t)return"0\uc2dc\uac04 0\ubd84";const r=(0,n.C)(e);let a=(0,n.C)(t);if(!r||!a)return"0\uc2dc\uac04 0\ubd84";a.isBefore(r)&&(a=a.add(1,"day"));const s=a.diff(r,"minute"),i=Math.floor(s/60),o=s%60;let l="";return i>0&&(l+="".concat(i,"\uc2dc\uac04 ")),l+="".concat(o,"\ubd84"),l.trim()},f=e=>{let{selectedDate:t,isOpen:r,onClose:s,session:n,jobs:f}=e;const h=(0,c.S)(),y=(0,m.d)(),[k,v]=(0,a.useState)([]),[p,w]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),[_,F]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),T=(0,a.useCallback)(async()=>{if(!n||!t)return;const e=i()(t).format("YYYY-MM-DD"),{data:r,error:a}=await l.N.from("work_records").select("*, jobs(job_name, color, break_time_enabled, break_time_paid, break_time_policies)").eq("date",e).eq("user_id",n.user.id).order("start_time",{ascending:!0});a?console.error("Error fetching daily records:",a):v(r)},[n,t]),[D,M]=(0,a.useState)(new Map),L=(0,a.useCallback)(async()=>{if(!n||!k.length||!t)return;const e=new Map,r=i()(t).format("YYYY-MM-DD");if("Invalid date"!==r&&i()(t).isValid()){for(const t of k)if("hourly"===t.wage_type&&t.job_id){const{data:a,error:s}=await l.N.from("hourly_rate_history").select("hourly_rate").eq("job_id",t.job_id).eq("user_id",n.user.id).lte("effective_date",r).or("end_date.is.null,end_date.gte."+r).order("effective_date",{ascending:!1}).limit(1);!s&&null!==a&&void 0!==a&&a[0]&&e.set(t.id,a[0].hourly_rate)}M(e)}else console.warn("Invalid selectedDate:",t)},[n,k,t]);(0,a.useEffect)(()=>{r&&k.length>0&&L()},[L,r,k.length]),(0,a.useEffect)(()=>{r?(F(!0),setTimeout(()=>S(!0),10),document.body.classList.add("modal-open"),T()):(S(!1),setTimeout(()=>{F(!1),M(new Map)},300),document.body.classList.remove("modal-open"))},[r,T]),(0,a.useEffect)(()=>()=>{document.body.classList.remove("modal-open")},[]);const Y=(0,a.useMemo)(()=>k.reduce((e,t)=>e+(t.daily_wage||0),0),[k]),E=(0,a.useMemo)(()=>k.reduce((e,t)=>{if("daily"===t.wage_type)return e+(t.daily_wage||0);if(t.start_time&&t.end_time&&t.jobs){const r=(0,o.n8)(t.start_time,t.end_time,t.jobs),a=D.get(t.id)||0;return e+(Math.round(r.totalHours*a)+(t.meal_allowance||0))}return e+(t.daily_wage||0)},0),[k,D]),H=(0,a.useMemo)(()=>{let e=0;return k.forEach(t=>{if(t.start_time&&t.end_time&&t.jobs){const r=(0,o.n8)(t.start_time,t.end_time,t.jobs);e+=r.breakTime.breakMinutes}}),e},[k]),P=E-Y,q=e=>{N(e),w(!0)};return _?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center transition-opacity duration-300 ease-out ".concat(C?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"," z-layer-modal"),children:(0,g.jsxs)("div",{className:"bg-cream-white dark:bg-gray-900 rounded-2xl shadow-lg dark:shadow-2xl dark:shadow-black/50 p-6 w-full max-w-md transform transition-all duration-300 ease-out ".concat(C?"translate-y-0 scale-100":"translate-y-10 scale-95"),children:[(0,g.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("h2",{className:"text-xl font-bold text-dark-navy dark:text-white",children:t&&i()(t).isValid()?i()(t).format("YYYY\ub144 M\uc6d4 D\uc77c (ddd)"):"\ub0a0\uc9dc \uc120\ud0dd"}),0===k.length&&(0,g.jsx)("div",{className:"mt-3 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-3",children:(0,g.jsxs)("div",{className:"flex items-start gap-3",children:[(0,g.jsx)("div",{className:"flex items-center",children:(0,g.jsx)("input",{type:"checkbox",id:"dayAbsence",className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500 dark:focus:ring-orange-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",onChange:e=>(async e=>{if(!n||!t)return;const r=i()(t).format("YYYY-MM-DD");if(e){const{error:e}=await l.N.from("work_records").insert({user_id:n.user.id,date:r,start_time:null,end_time:null,daily_wage:0,notes:"\ubb34\ub2e8\uacb0\uadfc",wage_type:"daily",work_description:"\ubb34\ub2e8\uacb0\uadfc",is_unexcused_absence:!0,job_id:null});if(e)console.error("Error creating absence record:",e),y("\ubb34\ub2e8\uacb0\uadfc \uae30\ub85d\uc5d0 \uc2e4\ud328\ud588\uc5b4\uc694","error");else{y("\ubb34\ub2e8\uacb0\uadfc\uc73c\ub85c \uae30\ub85d\ud588\uc5b4\uc694","success"),T();try{window.dispatchEvent(new Event("work-records-changed"))}catch(a){}}}else{const{error:e}=await l.N.from("work_records").delete().eq("user_id",n.user.id).eq("date",r).eq("is_unexcused_absence",!0);if(e)console.error("Error removing absence record:",e),y("\ubb34\ub2e8\uacb0\uadfc \ud574\uc81c\uc5d0 \uc2e4\ud328\ud588\uc5b4\uc694","error");else{y("\ubb34\ub2e8\uacb0\uadfc\uc744 \ud574\uc81c\ud588\uc5b4\uc694","success"),T();try{window.dispatchEvent(new Event("work-records-changed"))}catch(a){}}}})(e.target.checked)})}),(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("label",{htmlFor:"dayAbsence",className:"text-sm font-medium text-orange-800 dark:text-orange-200 cursor-pointer",children:"\u26a0\ufe0f \ubb34\ub2e8\uacb0\uadfc"}),(0,g.jsx)("p",{className:"text-xs text-orange-700 dark:text-orange-300 mt-1",children:"\ubb34\ub2e8\uacb0\uadfc\uc73c\ub85c \uccb4\ud06c\ud558\uba74 \ud574\ub2f9 \uc8fc\uc758 \uc8fc\ud734\uc218\ub2f9\uc774 \uc9c0\uae09\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4"})]})]})})]}),(0,g.jsx)("button",{onClick:s,className:"text-medium-gray dark:text-light-gray hover:text-dark-navy dark:hover:text-white text-2xl transition-all duration-200 ease-in-out transform hover:scale-105 ml-4",children:"\xd7"})]}),(0,g.jsx)("div",{className:"space-y-4 mb-6 max-h-60 overflow-y-auto",children:0===k.length?(0,g.jsx)("p",{className:"text-medium-gray dark:text-light-gray text-center py-4",children:"\uae30\ub85d\ub41c \uadfc\ubb34\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc9c0\uae08 \ubc14\ub85c \uccab \uadfc\ubb34\ub97c \ucd94\uac00\ud574\ubcf4\uc138\uc694!"}):k.map(e=>{var t,r,a;return(0,g.jsxs)("div",{className:"flex justify-between items-center py-3 border-b border-gray-100 dark:border-gray-600 last:border-b-0 rounded-md",children:[(0,g.jsxs)("div",{className:"flex-grow cursor-pointer p-2 -m-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 active:bg-gray-200 dark:active:bg-gray-600 transition-colors duration-150",onClick:()=>q(e),children:[(null===(t=e.jobs)||void 0===t?void 0:t.job_name)&&(0,g.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium self-start mb-1",style:(0,x.B)(e.jobs,!0),children:e.jobs.job_name}),(0,g.jsxs)("p",{className:"text-lg font-bold text-dark-navy dark:text-white",children:["+",(()=>{if("daily"===e.wage_type)return(e.daily_wage||0).toLocaleString();if(e.start_time&&e.end_time&&e.jobs){const t=D.get(e.id)||0;if(t>0){const r=(0,o.n8)(e.start_time,e.end_time,e.jobs);let a=r.workHours;r.breakTime.isPaid&&(a=r.totalHours);return(Math.round(a*t)+(e.meal_allowance||0)).toLocaleString()}}return(e.daily_wage||0).toLocaleString()})(),"\uc6d0"]}),(0,g.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:[(null===(r=e.start_time)||void 0===r?void 0:r.slice(0,5))||"--:--"," ~ ",(null===(a=e.end_time)||void 0===a?void 0:a.slice(0,5))||"--:--"]}),(0,g.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:["(",b(e.start_time,e.end_time),")"]}),(()=>{if(!e.start_time||!e.end_time||!e.jobs)return null;const t=(0,o.n8)(e.start_time,e.end_time,e.jobs),r=D.get(e.id)||0;if(0===t.breakTime.breakMinutes)return null;const a=r>0?(0,o.Et)(e.start_time,e.end_time,e.jobs,r):{wageDifference:0,breakTimePaid:0};return(0,g.jsxs)("div",{className:"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[(0,g.jsx)("div",{className:"flex justify-between items-center mb-1",children:(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[(0,g.jsx)("span",{className:"text-blue-600 dark:text-blue-400",children:"\u23f0"}),(0,g.jsxs)("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["\ud734\uac8c\uc2dc\uac04 ",(0,o.YL)(t.breakTime.breakMinutes)]}),(0,g.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded-full font-medium ".concat(t.breakTime.isPaid?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"),children:t.breakTime.isPaid?"\uc720\uae09":"\ubb34\uae09"})]})}),r>0&&(0,g.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,g.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:["\uc2dc\uae09 ",r.toLocaleString(),"\uc6d0"]}),(0,g.jsx)("span",{className:"font-semibold ".concat(t.breakTime.isPaid?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400"),children:t.breakTime.isPaid?"+".concat(a.breakTimePaid.toLocaleString(),"\uc6d0 \ud3ec\ud568"):"-".concat(a.wageDifference.toLocaleString(),"\uc6d0 \ucc28\uac10")})]}),0===r&&(0,g.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\uc2dc\uae09 \uc815\ubcf4 \uc5c6\uc74c (\ucc28\uc561 \uacc4\uc0b0 \ubd88\uac00)"})]})})(),(e.meal_allowance||0)>0&&(0,g.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:["\uc2dd\ub300: ",(e.meal_allowance||0).toLocaleString(),"\uc6d0"]}),e.notes&&(0,g.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:["\ube44\uace0: ",e.notes]})]}),(0,g.jsxs)("div",{className:"flex flex-col space-y-2 ml-4",children:[(0,g.jsx)("button",{onClick:()=>q(e),className:"p-2 rounded-full text-medium-gray dark:text-light-gray hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200","aria-label":"\ud3b8\uc9d1",children:(0,g.jsx)(u.R2l,{size:20})}),(0,g.jsx)("button",{onClick:()=>(async e=>{n&&h("\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc5b4\uc694?",async()=>{const{error:t}=await l.N.from("work_records").delete().eq("id",e).eq("user_id",n.user.id);t?(console.error("Error deleting record:",t),y("\uc0ad\uc81c\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")):(y("\uc0ad\uc81c\ud588\uc5b4\uc694","success"),T())})})(e.id),className:"p-2 rounded-full text-coral-pink hover:bg-red-100 dark:hover:bg-red-900 transition-colors duration-200","aria-label":"\uc0ad\uc81c",children:(0,g.jsx)(u.otA,{size:20})})]})]},e.id)})}),(0,g.jsxs)("div",{className:"mt-6 flex flex-col justify-between items-center p-4 bg-cream-white dark:bg-charcoal-gray border-t border-gray-200 dark:border-gray-700 rounded-b-2xl -mx-6 -mb-6 space-y-3",children:[Y>0&&(0,g.jsxs)("div",{className:"text-center space-y-1 mb-4",children:[E>Y?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["\uae30\ubcf8 \uc608\uc0c1: ",E.toLocaleString(),"\uc6d0"]}),(0,g.jsxs)("p",{className:"text-lg font-semibold text-mint-green dark:text-mint-green-light",children:["\uc2e4\uc81c \uc77c\uae09: ",Y.toLocaleString(),"\uc6d0"]}),(0,g.jsxs)("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:["\ud83d\udcb8 \ud734\uac8c\uc2dc\uac04 \ucc28\uac10: -",P.toLocaleString(),"\uc6d0"]})]}):(0,g.jsxs)("p",{className:"text-lg font-semibold text-mint-green dark:text-mint-green-light",children:["\ucd1d \uc77c\uae09: ",Y.toLocaleString(),"\uc6d0"]}),H>0&&(0,g.jsx)("div",{className:"text-sm space-y-1",children:(0,g.jsxs)("p",{className:"text-blue-600 dark:text-blue-400",children:["\ud83d\udd50 \ucd1d \ud734\uac8c\uc2dc\uac04: ",(0,o.YL)(H)]})})]}),(0,g.jsxs)("div",{className:"flex flex-col gap-3 w-full",children:[(0,g.jsx)("button",{onClick:()=>{N(null),w(!0)},className:"px-3 py-2 bg-mint-green dark:bg-mint-green-dark text-white rounded-full font-medium hover:bg-mint-green-dark dark:hover:bg-mint-green focus:outline-none focus:ring-2 focus:ring-mint-green dark:focus:ring-mint-green-dark focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105 flex items-center justify-center space-x-2 w-full",children:(0,g.jsx)(u.c11,{size:25,className:"font-black"})}),(0,g.jsx)("button",{onClick:s,className:"px-3 py-2 bg-medium-gray dark:bg-gray-600 text-white rounded-full font-medium hover:bg-gray-600 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-medium-gray dark:focus:ring-gray-500 focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105 w-full",children:"\ub2eb\uae30"})]})]})]})}),p&&(0,g.jsx)(d.default,{selectedDate:t,isOpen:p,onClose:()=>{w(!1),N(null),T();try{window.dispatchEvent(new Event("work-records-changed"))}catch(e){}},session:n,jobs:f,recordToEdit:j,size:"large"})]}):null}},5016:(e,t,r)=>{r.r(t),r.d(t,{default:()=>b});var a=r(9379),s=r(5043),i=r(446),n=r.n(i),o=r(2521),l=r(5843),d=r(253),c=r(9994),m=r(2901),u=(r(5015),r(61)),x=r(6632),g=r(579);const b=e=>{var t,r;let{selectedDate:i,isOpen:b,onClose:f,session:h,jobs:y,recordToEdit:k,size:v="medium",prefill:p}=e;const w=(0,d.d)(),j=(0,c.S)(),[N,_]=(0,s.useState)(""),[F,C]=(0,s.useState)(""),[S,T]=(0,s.useState)(0),[D,M]=(0,s.useState)(""),[L,Y]=(0,s.useState)(0),[E,H]=(0,s.useState)(null),[P,q]=(0,s.useState)(0),[A,I]=(0,s.useState)(!1),[z,B]=(0,s.useState)(null),[O,U]=(0,s.useState)("hourly"),[V,R]=(0,s.useState)(0),[W,$]=(0,s.useState)({breakMinutes:0,breakHours:0,isPaid:!1}),[G,J]=(0,s.useState)(!1),[K,Q]=(0,s.useState)({breakTimePaid:0,breakTimeUnpaid:0,wageDifference:0}),[X,Z]=(0,s.useState)(!1),[ee,te]=(0,s.useState)(!1),re=(0,s.useCallback)(()=>{_(""),C(""),T(0),M(""),Y(0),H(null),I(!1),U("hourly"),R(0),B(null),$({breakMinutes:0,breakHours:0,isPaid:!1}),J(!1),Q({breakTimePaid:0,breakTimeUnpaid:0,wageDifference:0})},[]);(0,s.useEffect)(()=>{y.length>0&&!z&&B(y[0].id)},[y,z]),(0,s.useEffect)(()=>{b?(Z(!0),setTimeout(()=>te(!0),10),document.body.classList.add("modal-open"),k?(H(k.id),B(k.job_id),_(k.start_time?k.start_time.slice(0,5):""),C(k.end_time?k.end_time.slice(0,5):""),T(k.meal_allowance||0),M(k.notes||""),Y(k.daily_wage||0),U(k.wage_type||"hourly"),"daily"===k.wage_type&&R(k.daily_wage||0)):(re(),y.length>0&&B(y[0].id),p&&(p.jobId&&B(p.jobId),p.start&&_(p.start),p.end&&C(p.end),p.wageType&&U(p.wageType)))):(te(!1),setTimeout(()=>Z(!1),300),document.body.classList.remove("modal-open"))},[b,k,p,y,re]),(0,s.useEffect)(()=>{b||setTimeout(()=>{re()},350)},[b,re]),(0,s.useEffect)(()=>()=>{document.body.classList.remove("modal-open")},[]),(0,s.useEffect)(()=>{(async()=>{if(!h||!z||!i)return void q(0);const{data:e,error:t}=await l.N.from("hourly_rate_history").select("hourly_rate").eq("user_id",h.user.id).eq("job_id",z).lte("effective_date",n()(i).format("YYYY-MM-DD")).or("end_date.gte.".concat(n()(i).format("YYYY-MM-DD"),",end_date.is.null")).order("effective_date",{ascending:!1}).limit(1);t?(console.error("Error fetching hourly rate for date:",t),q(0)):e&&e.length>0?q(e[0].hourly_rate):q(0)})()},[h,z,i]);const ae=(0,s.useMemo)(()=>y.find(e=>e.id===z),[y,z]);(0,s.useEffect)(()=>{if("hourly"===O)if(N&&F&&0!==P){const e=(0,o.C)(N);let t=(0,o.C)(F);if(!e||!t)return Y(0),void $({breakMinutes:0,breakHours:0,isPaid:!1});if(t.isBefore(e))return I(!0),Y(0),void $({breakMinutes:0,breakHours:0,isPaid:!1});I(!1);const r=(0,x.n8)(N,F,ae);$(r.breakTime);const a=(0,x.Et)(N,F,ae,P);Q(a);let s=r.workHours;r.breakTime.isPaid&&(s=r.totalHours);const i=Math.round(s*P)+S;E&&k&&Math.abs(i-((null===k||void 0===k?void 0:k.daily_wage)||0))>100?J(!0):J(!1),Y(i)}else Y(0),$({breakMinutes:0,breakHours:0,isPaid:!1}),Q({breakTimePaid:0,breakTimeUnpaid:0,wageDifference:0});else if("daily"===O)if(I(!1),Y(V+S),N&&F){const e=(0,x.n8)(N,F,ae);$(e.breakTime),Q({breakTimePaid:0,breakTimeUnpaid:0,wageDifference:0})}else $({breakMinutes:0,breakHours:0,isPaid:!1}),Q({breakTimePaid:0,breakTimeUnpaid:0,wageDifference:0})},[O,N,F,P,S,V,ae,E,k]);if(!X)return null;const se={small:"max-w-md",medium:"max-w-xl",large:"max-w-3xl",full:"max-w-full"}[v];return(0,g.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex justify-center items-center transition-opacity duration-300 ease-out ".concat(ee?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"," overflow-y-auto p-4 z-layer-modal"),children:(0,g.jsxs)("div",{className:"bg-cream-white dark:bg-gray-900 rounded-2xl shadow-lg dark:shadow-2xl dark:shadow-black/50 p-6 w-full ".concat(se," transform transition-all duration-300 ease-out ").concat(ee?"translate-y-0 scale-100":"translate-y-10 scale-95"," my-auto"),children:[(0,g.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,g.jsx)("h2",{className:"text-xl font-bold text-dark-navy dark:text-white",children:k?"\uadfc\ubb34 \uae30\ub85d \ud3b8\uc9d1":"\uc0c8 \uadfc\ubb34 \uae30\ub85d"}),(0,g.jsx)("button",{onClick:f,className:"text-medium-gray dark:text-light-gray hover:text-dark-navy dark:hover:text-white text-2xl transition-all duration-200 ease-in-out transform hover:scale-105",children:"\xd7"})]}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc9c1\uc5c5 \uc120\ud0dd"}),(0,g.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:0===y.length?(0,g.jsx)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:"\uc9c1\uc5c5\uc744 \ucd94\uac00\ud574\uc8fc\uc138\uc694"}):y.map(e=>(0,g.jsx)("button",{onClick:()=>B(e.id),className:"px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 hover:scale-105 transform",style:(0,u.B)(e,z===e.id),children:e.job_name},e.id))})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-medium-gray dark:text-light-gray mb-2",children:"\uae09\uc5ec \ubc29\uc2dd"}),(0,g.jsxs)("div",{className:"flex gap-2",children:[(0,g.jsx)("button",{onClick:()=>U("hourly"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 ".concat("hourly"===O?"bg-mint-green text-white":"bg-gray-200 text-dark-navy dark:bg-gray-700 dark:text-white"),children:"\uc2dc\uae09\uc81c"}),(0,g.jsx)("button",{onClick:()=>U("daily"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 ".concat("daily"===O?"bg-mint-green text-white":"bg-gray-200 text-dark-navy dark:bg-gray-700 dark:text-white"),children:"\uc77c\uae09\uc81c"})]})]}),"hourly"===O&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"hourlyRateDisplay",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc801\uc6a9 \uc2dc\uae09"}),(0,g.jsx)("input",{type:"text",id:"hourlyRateDisplay",value:"".concat(null!=P?P.toLocaleString():"0","\uc6d0"),readOnly:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md  bg-gray-100 dark:bg-gray-700 text-dark-navy dark:text-white sm:text-sm"})]}),"daily"===O&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"fixedDailyWage",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc77c\uae09 (\uc6d0)"}),(0,g.jsx)("input",{type:"number",id:"fixedDailyWage",value:V||"",onChange:e=>R(Math.max(0,parseInt(e.target.value)||0)),placeholder:"\uc608: 150000",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]}),(0,g.jsxs)("div",{className:"flex gap-4",children:[(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("label",{htmlFor:"startTime",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ucd9c\uadfc \uc2dc\uac04"}),(0,g.jsx)(m.Ay,{id:"startTime",selected:/^\d{2}:\d{2}$/.test(N)&&(null===(t=(0,o.C)(N))||void 0===t?void 0:t.toDate())||null,onChange:e=>{if(!e)return void _("");const t=n()(e);t.isValid()?_(t.format("HH:mm")):_("")},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,dateFormat:"HH:mm",timeFormat:"HH:mm",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white",inputProps:{autoComplete:"off"}})]}),(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("label",{htmlFor:"endTime",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ud1f4\uadfc \uc2dc\uac04"}),(0,g.jsx)(m.Ay,{id:"endTime",selected:/^\d{2}:\d{2}$/.test(F)&&(null===(r=(0,o.C)(F))||void 0===r?void 0:r.toDate())||null,onChange:e=>{if(!e)return void C("");const t=n()(e);t.isValid()?C(t.format("HH:mm")):C("")},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,dateFormat:"HH:mm",timeFormat:"HH:mm",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white",inputProps:{autoComplete:"off"}})]})]}),A&&(0,g.jsx)("p",{className:"text-red-500 text-xs mt-1",children:"\ud1f4\uadfc \uc2dc\uac04\uc740 \ucd9c\uadfc \uc2dc\uac04\ubcf4\ub2e4 \ub2a6\uc5b4\uc57c \ud574\uc694."}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"mealAllowance",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc2dd\ub300 (\uc6d0)"}),(0,g.jsx)("input",{type:"number",id:"mealAllowance",value:S||"",onChange:e=>T(Math.max(0,parseInt(e.target.value)||0)),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ube44\uace0"}),(0,g.jsx)("textarea",{id:"notes",rows:"2",value:D||"",onChange:e=>M(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]})]}),(0,g.jsxs)("div",{className:"mt-6 text-right text-lg font-semibold text-mint-green",children:["\uc608\uc0c1 \uc77c\uae09: ",L.toLocaleString(),"\uc6d0"]}),W.breakMinutes>0&&(0,g.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,g.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,g.jsx)("span",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"\ud83d\udccb \uc608\uc0c1 \ud734\uac8c\uc2dc\uac04"}),(0,g.jsx)("span",{className:"text-blue-800 dark:text-blue-200 font-semibold",children:(0,x.YL)(W.breakMinutes)})]}),"hourly"===O&&W.breakMinutes>0&&(0,g.jsx)("div",{className:"mt-2 pt-2 border-t border-blue-200 dark:border-blue-700",children:W.isPaid?(0,g.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,g.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"\ud83d\udcb0 \ud734\uac8c\uc2dc\uac04 \uae09\uc5ec \ud3ec\ud568"}),(0,g.jsxs)("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["+",K.breakTimePaid.toLocaleString(),"\uc6d0"]})]}):(0,g.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,g.jsx)("span",{className:"text-orange-600 dark:text-orange-400",children:"\ud83d\udcb8 \ud734\uac8c\uc2dc\uac04 \ubb34\uae09 \ucc28\uac10"}),(0,g.jsxs)("span",{className:"text-orange-600 dark:text-orange-400 font-medium",children:["-",K.wageDifference.toLocaleString(),"\uc6d0"]})]})}),"daily"===O&&(0,g.jsx)("div",{className:"mt-1 text-xs text-blue-600 dark:text-blue-400",children:"\u2139\ufe0f \uc77c\uae09\uc81c\ub294 \ud734\uac8c\uc2dc\uac04\uc774 \uae09\uc5ec\uc5d0 \uc601\ud5a5 \uc5c6\uc74c"})]}),G&&(0,g.jsx)("div",{className:"mt-3 p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800",children:(0,g.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,g.jsx)("span",{className:"text-amber-600 dark:text-amber-400 text-lg",children:"\u26a1"}),(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:"\ud734\uac8c\uc2dc\uac04 \uc815\ucc45 \uc801\uc6a9\uc73c\ub85c \uae09\uc5ec\uac00 \uc7ac\uacc4\uc0b0\ub418\uc5c8\uc2b5\ub2c8\ub2e4"}),(0,g.jsxs)("p",{className:"text-xs text-amber-700 dark:text-amber-300 mt-1",children:["\uae30\uc874: ",((null===k||void 0===k?void 0:k.daily_wage)||0).toLocaleString(),"\uc6d0 \u2192 \uc0c8 \uacc4\uc0b0: ",L.toLocaleString(),"\uc6d0"]})]})]})}),(0,g.jsxs)("div",{className:"mt-6 flex flex-col-reverse gap-3",children:[E&&(0,g.jsx)("button",{onClick:async()=>{E?j("\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc5b4\uc694?",async()=>{try{const{error:e}=await l.N.from("work_records").delete().eq("id",E);if(e)throw e;w("\uc0ad\uc81c\ud588\uc5b4\uc694","success"),f(),re()}catch(e){console.error("\uadfc\ubb34 \uae30\ub85d \uc0ad\uc81c \uc624\ub958:",e),w("\uc0ad\uc81c\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")}}):w("\uc0ad\uc81c\ud560 \uae30\ub85d\uc774 \uc5c6\uc5b4\uc694","error")},className:"w-full px-6 py-3 text-white bg-coral-pink rounded-full font-medium hover:bg-coral-pink-dark focus:outline-none focus:ring-2 focus:ring-coral-pink focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\uc0ad\uc81c"}),(0,g.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,g.jsx)("button",{onClick:f,className:"w-full px-3 py-2 bg-medium-gray text-white rounded-full font-medium hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-medium-gray focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\ucde8\uc18c"}),(0,g.jsx)("button",{onClick:re,className:"w-full px-3 py-2 bg-gray-200 text-dark-navy rounded-full font-medium hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-200 focus:ring-opacity-50 transition-all duration-200  ease-in-out transform hover:scale-105 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",children:"\ucd08\uae30\ud654"}),(0,g.jsx)("button",{onClick:async()=>{if(!h||!z||!i)return void w("\ud544\uc218 \uc815\ubcf4\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if("hourly"===O){if(!N||!F)return void w("\uc2dc\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if(0===P)return void w("\ud574\ub2f9 \uc9c1\uc5c5\uc758 \uc2dc\uae09\uc744 \uc124\uc815\ud574\uc8fc\uc138\uc694.","error");const e=(0,o.C)(N),t=(0,o.C)(F);if(!e||!t)return void w("\uc2dc\uac04 \ud615\uc2dd\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.","error");if(t.isBefore(e))return void w("\ud1f4\uadfc \uc2dc\uac04\uc744 \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.","error")}else if("daily"===O){if(V<=0)return void w("\uc77c\uae09\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if(!N||!F)return void w("\uadfc\ubb34\uc2dc\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");const e=(0,o.C)(N),t=(0,o.C)(F);if(!e||!t)return void w("\uc2dc\uac04 \ud615\uc2dd\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.","error");if(t.isBefore(e))return void w("\ud1f4\uadfc \uc2dc\uac04\uc744 \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.","error")}let e={user_id:h.user.id,job_id:z,date:n()(i).format("YYYY-MM-DD"),meal_allowance:S,notes:D,wage_type:O,work_description:D};if("hourly"===O){const t=(0,x.n8)(N,F,ae);let r=t.workHours;t.breakTime.isPaid&&(r=t.totalHours);const s=Math.round(r*P)+S;e=(0,a.A)((0,a.A)({},e),{},{start_time:N,end_time:F,daily_wage:s})}else"daily"===O&&(e=(0,a.A)((0,a.A)({},e),{},{start_time:N,end_time:F,daily_wage:V+S}));try{if(E){const{error:t}=await l.N.from("work_records").update(e).eq("id",E);if(t)throw t;w("\uc218\uc815\ud588\uc5b4\uc694","success")}else{const{error:t}=await l.N.from("work_records").insert([e]);if(t)throw t;w("\uc800\uc7a5\ud588\uc5b4\uc694","success")}try{window.dispatchEvent(new Event("work-records-changed"))}catch(t){}f(),re()}catch(r){console.error("\uadfc\ubb34 \uae30\ub85d \uc800\uc7a5 \uc624\ub958:",r),w("\uc800\uc7a5\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")}},className:"w-full px-3 py-2 bg-mint-green text-white rounded-full font-medium hover:bg-mint-green-dark focus:outline-none focus:ring-2 focus:ring-mint-green focus:ring-opacity-50 transition-all duration-200  ease-in-out transform hover:scale-105",children:"\uc800\uc7a5"})]})]})]})})}}}]);