/*! For license information please see 908.d8574eb2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkszwagecalc=self.webpackChunkszwagecalc||[]).push([[16,908],{16:(e,t,r)=>{r.r(t),r.d(t,{default:()=>x});var a=r(379),o=r(43),s=r(446),i=r.n(s),n=r(521),l=r(312),d=r(253),c=r(994),m=r(328),u=(r(15),r(61)),g=r(579);const x=e=>{var t,r;let{selectedDate:s,isOpen:x,onClose:h,session:f,jobs:y,recordToEdit:b,size:v="medium",prefill:p}=e;const k=(0,d.d)(),w=(0,c.S)(),[j,N]=(0,o.useState)(""),[F,C]=(0,o.useState)(""),[_,S]=(0,o.useState)(0),[A,D]=(0,o.useState)(""),[E,L]=(0,o.useState)(0),[M,Y]=(0,o.useState)(null),[T,z]=(0,o.useState)(0),[H,B]=(0,o.useState)(!1),[W,I]=(0,o.useState)(null),[q,O]=(0,o.useState)("hourly"),[R,V]=(0,o.useState)(0),[$,P]=(0,o.useState)(!1),[U,Z]=(0,o.useState)(!1),G=(0,o.useCallback)(()=>{N(""),C(""),S(0),D(""),L(0),Y(null),B(!1),O("hourly"),V(0),I(null)},[]);(0,o.useEffect)(()=>{y.length>0&&!W&&I(y[0].id)},[y,W]),(0,o.useEffect)(()=>{x?(P(!0),setTimeout(()=>Z(!0),10),document.body.classList.add("modal-open"),b?(Y(b.id),I(b.job_id),N(b.start_time?b.start_time.slice(0,5):""),C(b.end_time?b.end_time.slice(0,5):""),S(b.meal_allowance||0),D(b.notes||""),L(b.daily_wage||0),O(b.wage_type||"hourly"),"daily"===b.wage_type&&V(b.daily_wage||0)):(G(),y.length>0&&I(y[0].id),p&&(p.jobId&&I(p.jobId),p.start&&N(p.start),p.end&&C(p.end),p.wageType&&O(p.wageType)))):(Z(!1),setTimeout(()=>P(!1),300),document.body.classList.remove("modal-open"))},[x,b,p,y,G]),(0,o.useEffect)(()=>{x||setTimeout(()=>{G()},350)},[x,G]),(0,o.useEffect)(()=>()=>{document.body.classList.remove("modal-open")},[]),(0,o.useEffect)(()=>{(async()=>{if(!f||!W||!s)return void z(0);const{data:e,error:t}=await l.N.from("hourly_rate_history").select("hourly_rate").eq("user_id",f.user.id).eq("job_id",W).lte("effective_date",i()(s).format("YYYY-MM-DD")).or("end_date.gte.".concat(i()(s).format("YYYY-MM-DD"),",end_date.is.null")).order("effective_date",{ascending:!1}).limit(1);t?(console.error("Error fetching hourly rate for date:",t),z(0)):e&&e.length>0?z(e[0].hourly_rate):z(0)})()},[f,W,s]),(0,o.useEffect)(()=>{if("hourly"===q)if(j&&F&&0!==T){const e=(0,n.C)(j);let t=(0,n.C)(F);if(!e||!t)return void L(0);if(t.isBefore(e))return B(!0),void L(0);B(!1);const r=t.diff(e,"minute")/60,a=Math.round(r*T)+_;L(a)}else L(0);else"daily"===q&&(B(!1),L(R+_))},[q,j,F,T,_,R]);if(!$)return null;const J={small:"max-w-md",medium:"max-w-xl",large:"max-w-3xl",full:"max-w-full"}[v];return(0,g.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center transition-opacity duration-300 ease-out ".concat(U?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"," overflow-y-auto p-4 z-layer-modal"),children:(0,g.jsxs)("div",{className:"bg-cream-white dark:bg-charcoal-gray rounded-2xl shadow-lg p-6 w-full ".concat(J," transform transition-all duration-300 ease-out ").concat(U?"translate-y-0 scale-100":"translate-y-10 scale-95"," my-auto"),children:[(0,g.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,g.jsx)("h2",{className:"text-xl font-bold text-dark-navy dark:text-white",children:b?"\uadfc\ubb34 \uae30\ub85d \ud3b8\uc9d1":"\uc0c8 \uadfc\ubb34 \uae30\ub85d"}),(0,g.jsx)("button",{onClick:h,className:"text-medium-gray dark:text-light-gray hover:text-dark-navy dark:hover:text-white text-2xl transition-all duration-200 ease-in-out transform hover:scale-105",children:"\xd7"})]}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc9c1\uc5c5 \uc120\ud0dd"}),(0,g.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:0===y.length?(0,g.jsx)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:"\uc9c1\uc5c5\uc744 \ucd94\uac00\ud574\uc8fc\uc138\uc694"}):y.map(e=>(0,g.jsx)("button",{onClick:()=>I(e.id),className:"px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 hover:scale-105 transform",style:(0,u.B)(e,W===e.id),children:e.job_name},e.id))})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-medium-gray dark:text-light-gray mb-2",children:"\uae09\uc5ec \ubc29\uc2dd"}),(0,g.jsxs)("div",{className:"flex gap-2",children:[(0,g.jsx)("button",{onClick:()=>O("hourly"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 ".concat("hourly"===q?"bg-mint-green text-white":"bg-gray-200 text-dark-navy dark:bg-gray-700 dark:text-white"),children:"\uc2dc\uae09\uc81c"}),(0,g.jsx)("button",{onClick:()=>O("daily"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 ".concat("daily"===q?"bg-mint-green text-white":"bg-gray-200 text-dark-navy dark:bg-gray-700 dark:text-white"),children:"\uc77c\uae09\uc81c"})]})]}),"hourly"===q&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"hourlyRateDisplay",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc801\uc6a9 \uc2dc\uae09"}),(0,g.jsx)("input",{type:"text",id:"hourlyRateDisplay",value:"".concat(null!=T?T.toLocaleString():"0","\uc6d0"),readOnly:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md  bg-gray-100 dark:bg-gray-700 text-dark-navy dark:text-white sm:text-sm"})]}),"daily"===q&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"fixedDailyWage",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc77c\uae09 (\uc6d0)"}),(0,g.jsx)("input",{type:"number",id:"fixedDailyWage",value:R||"",onChange:e=>V(Math.max(0,parseInt(e.target.value)||0)),placeholder:"\uc608: 150000",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]}),(0,g.jsxs)("div",{className:"flex gap-4",children:[(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("label",{htmlFor:"startTime",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ucd9c\uadfc \uc2dc\uac04"}),(0,g.jsx)(m.Ay,{id:"startTime",selected:/^\d{2}:\d{2}$/.test(j)&&(null===(t=(0,n.C)(j))||void 0===t?void 0:t.toDate())||null,onChange:e=>{if(!e)return void N("");const t=i()(e);t.isValid()?N(t.format("HH:mm")):N("")},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,dateFormat:"HH:mm",timeFormat:"HH:mm",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white",inputProps:{autoComplete:"off"}})]}),(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("label",{htmlFor:"endTime",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ud1f4\uadfc \uc2dc\uac04"}),(0,g.jsx)(m.Ay,{id:"endTime",selected:/^\d{2}:\d{2}$/.test(F)&&(null===(r=(0,n.C)(F))||void 0===r?void 0:r.toDate())||null,onChange:e=>{if(!e)return void C("");const t=i()(e);t.isValid()?C(t.format("HH:mm")):C("")},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,dateFormat:"HH:mm",timeFormat:"HH:mm",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white",inputProps:{autoComplete:"off"}})]})]}),H&&(0,g.jsx)("p",{className:"text-red-500 text-xs mt-1",children:"\ud1f4\uadfc \uc2dc\uac04\uc740 \ucd9c\uadfc \uc2dc\uac04\ubcf4\ub2e4 \ub2a6\uc5b4\uc57c \ud574\uc694."}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"mealAllowance",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\uc2dd\ub300 (\uc6d0)"}),(0,g.jsx)("input",{type:"number",id:"mealAllowance",value:_||"",onChange:e=>S(Math.max(0,parseInt(e.target.value)||0)),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-medium-gray dark:text-light-gray",children:"\ube44\uace0"}),(0,g.jsx)("textarea",{id:"notes",rows:"2",value:A||"",onChange:e=>D(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-md focus:outline-none focus:ring-mint-green focus:border-mint-green sm:text-sm bg-white dark:bg-charcoal-gray text-dark-navy dark:text-white"})]})]}),(0,g.jsxs)("div",{className:"mt-6 text-right text-lg font-semibold text-mint-green",children:["\uc608\uc0c1 \uc77c\uae09: ",E.toLocaleString(),"\uc6d0"]}),(0,g.jsxs)("div",{className:"mt-6 flex flex-col-reverse gap-3",children:[M&&(0,g.jsx)("button",{onClick:async()=>{M?w("\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc5b4\uc694?",async()=>{try{const{error:e}=await l.N.from("work_records").delete().eq("id",M);if(e)throw e;k("\uc0ad\uc81c\ud588\uc5b4\uc694","success"),h(),G()}catch(e){console.error("\uadfc\ubb34 \uae30\ub85d \uc0ad\uc81c \uc624\ub958:",e),k("\uc0ad\uc81c\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")}}):k("\uc0ad\uc81c\ud560 \uae30\ub85d\uc774 \uc5c6\uc5b4\uc694","error")},className:"w-full px-6 py-3 text-white bg-coral-pink rounded-full font-medium hover:bg-coral-pink-dark focus:outline-none focus:ring-2 focus:ring-coral-pink focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\uc0ad\uc81c"}),(0,g.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,g.jsx)("button",{onClick:h,className:"w-full px-3 py-2 bg-medium-gray text-white rounded-full font-medium hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-medium-gray focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105",children:"\ucde8\uc18c"}),(0,g.jsx)("button",{onClick:G,className:"w-full px-3 py-2 bg-gray-200 text-dark-navy rounded-full font-medium hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-200 focus:ring-opacity-50 transition-all duration-200  ease-in-out transform hover:scale-105 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",children:"\ucd08\uae30\ud654"}),(0,g.jsx)("button",{onClick:async()=>{if(!f||!W||!s)return void k("\ud544\uc218 \uc815\ubcf4\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if("hourly"===q){if(!j||!F)return void k("\uc2dc\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if(0===T)return void k("\ud574\ub2f9 \uc9c1\uc5c5\uc758 \uc2dc\uae09\uc744 \uc124\uc815\ud574\uc8fc\uc138\uc694.","error");const e=(0,n.C)(j),t=(0,n.C)(F);if(!e||!t)return void k("\uc2dc\uac04 \ud615\uc2dd\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.","error");if(t.isBefore(e))return void k("\ud1f4\uadfc \uc2dc\uac04\uc744 \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.","error")}else if("daily"===q){if(R<=0)return void k("\uc77c\uae09\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");if(!j||!F)return void k("\uadfc\ubb34\uc2dc\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.","error");const e=(0,n.C)(j),t=(0,n.C)(F);if(!e||!t)return void k("\uc2dc\uac04 \ud615\uc2dd\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.","error");if(t.isBefore(e))return void k("\ud1f4\uadfc \uc2dc\uac04\uc744 \ub2e4\uc2dc \ud655\uc778\ud574\uc8fc\uc138\uc694.","error")}let e={user_id:f.user.id,job_id:W,date:i()(s).format("YYYY-MM-DD"),meal_allowance:_,notes:A,wage_type:q,work_description:A};if("hourly"===q){const t=(0,n.C)(j),r=(0,n.C)(F).diff(t,"minute")/60,o=Math.round(r*T)+_;e=(0,a.A)((0,a.A)({},e),{},{start_time:j,end_time:F,daily_wage:o})}else"daily"===q&&(e=(0,a.A)((0,a.A)({},e),{},{start_time:j,end_time:F,daily_wage:R+_}));try{if(M){const{error:t}=await l.N.from("work_records").update(e).eq("id",M);if(t)throw t;k("\uc218\uc815\ud588\uc5b4\uc694","success")}else{const{error:t}=await l.N.from("work_records").insert([e]);if(t)throw t;k("\uc800\uc7a5\ud588\uc5b4\uc694","success")}try{window.dispatchEvent(new Event("work-records-changed"))}catch(t){}h(),G()}catch(r){console.error("\uadfc\ubb34 \uae30\ub85d \uc800\uc7a5 \uc624\ub958:",r),k("\uc800\uc7a5\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")}},className:"w-full px-3 py-2 bg-mint-green text-white rounded-full font-medium hover:bg-mint-green-dark focus:outline-none focus:ring-2 focus:ring-mint-green focus:ring-opacity-50 transition-all duration-200  ease-in-out transform hover:scale-105",children:"\uc800\uc7a5"})]})]})]})})}},61:(e,t,r)=>{r.d(t,{B:()=>i,j:()=>a});const a=[{id:"brand-purple",name:"\ube0c\ub79c\ub4dc \ud37c\ud50c",value:"var(--accent-primary)",textLight:"var(--accent-text)",textDark:"var(--accent-text)",inactive:"rgba(139, 92, 246, 0.25)"},{id:"success-green",name:"\uc11d\uc138\uc2a4 \uadf8\ub9b0",value:"var(--success-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(34, 197, 94, 0.25)"},{id:"warning-orange",name:"\uc6cc\ub2dd \uc624\ub80c\uc9c0",value:"var(--warning-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(249, 115, 22, 0.25)"},{id:"error-red",name:"\uc5d0\ub7ec \ub808\ub4dc",value:"var(--error-primary)",textLight:"var(--text-inverse)",textDark:"var(--text-inverse)",inactive:"rgba(239, 68, 68, 0.25)"},{id:"blue",name:"\ube14\ub8e8",value:"#2563EB",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(37, 99, 235, 0.25)"},{id:"fuchsia",name:"\ud4e8\uc2dc\uc544",value:"#C026D3",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(192, 38, 211, 0.25)"},{id:"coffee-brown",name:"\ucee4\ud53c \ube0c\ub77c\uc6b4",value:"#8B5E3C",textLight:"#FFFFFF",textDark:"#FFFFFF",inactive:"rgba(139, 94, 60, 0.25)"}],o=a[0],s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=a.find(t=>t.value===e);if(r)return t?r.textDark:r.textLight;if(!e)return t?"#FFFFFF":"#1F2937";if(e.startsWith("var("))return"var(--text-inverse)";const o=e.replace("#","");return(.299*parseInt(o.substr(0,2),16)+.587*parseInt(o.substr(2,2),16)+.114*parseInt(o.substr(4,2),16))/255>.5?"#1F2937":"#FFFFFF"},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.color||o.value,n=(l=i,a.find(e=>e.value===l)||o);var l;return t?{backgroundColor:i,color:s(i,r),borderColor:i}:{backgroundColor:n?n.inactive:"rgba(0,0,0,0.1)",color:"var(--text-secondary)",borderColor:n?n.inactive:"rgba(0,0,0,0.1)"}}},360:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(784).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},505:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(784).A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},784:(e,t,r)=>{r.d(t,{A:()=>u});var a=r(379),o=r(986),s=r(43);const i=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const d=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],c=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:m,className:u="",children:g,iconNode:x}=e,h=(0,o.A)(e,d);return(0,s.createElement)("svg",(0,a.A)((0,a.A)((0,a.A)({ref:t},l),{},{width:i,height:i,stroke:r,strokeWidth:m?24*Number(c)/Number(i):c,className:n("lucide",u)},!g&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"}),h),[...x.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(g)?g:[g]])}),m=["className"],u=(e,t)=>{const r=(0,s.forwardRef)((r,l)=>{let{className:d}=r,u=(0,o.A)(r,m);return(0,s.createElement)(c,(0,a.A)({ref:l,iconNode:t,className:n("lucide-".concat((g=i(e),g.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),d)},u));var g});return r.displayName=i(e),r}},855:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(784).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},908:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y});var a=r(43),o=r(446),s=r.n(o),i=r(521),n=r(312),l=r(16),d=r(994),c=r(253),m=r(505),u=r(855),g=r(360),x=r(61),h=r(579);const f=(e,t)=>{if(!e||!t)return"0\uc2dc\uac04 0\ubd84";const r=(0,i.C)(e);let a=(0,i.C)(t);if(!r||!a)return"0\uc2dc\uac04 0\ubd84";a.isBefore(r)&&(a=a.add(1,"day"));const o=a.diff(r,"minute"),s=Math.floor(o/60),n=o%60;let l="";return s>0&&(l+="".concat(s,"\uc2dc\uac04 ")),l+="".concat(n,"\ubd84"),l.trim()},y=e=>{let{selectedDate:t,isOpen:r,onClose:o,session:i,jobs:y}=e;const b=(0,d.S)(),v=(0,c.d)(),[p,k]=(0,a.useState)([]),[w,j]=(0,a.useState)(!1),[N,F]=(0,a.useState)(null),[C,_]=(0,a.useState)(!1),[S,A]=(0,a.useState)(!1),D=(0,a.useCallback)(async()=>{if(!i||!t)return;const e=s()(t).format("YYYY-MM-DD"),{data:r,error:a}=await n.N.from("work_records").select("*, jobs(job_name, color)").eq("date",e).eq("user_id",i.user.id).order("start_time",{ascending:!0});a?console.error("Error fetching daily records:",a):k(r)},[i,t]);(0,a.useEffect)(()=>{r?(_(!0),setTimeout(()=>A(!0),10),document.body.classList.add("modal-open"),D()):(A(!1),setTimeout(()=>_(!1),300),document.body.classList.remove("modal-open"))},[r,D]),(0,a.useEffect)(()=>()=>{document.body.classList.remove("modal-open")},[]);const E=(0,a.useMemo)(()=>p.reduce((e,t)=>e+(t.daily_wage||0),0),[p]),L=e=>{console.log("handleEditRecord called with record:",e),F(e),j(!0),console.log("Modal should open with selectedRecordForEdit:",e)};return C?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center transition-opacity duration-300 ease-out ".concat(S?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"," z-layer-modal"),children:(0,h.jsxs)("div",{className:"bg-cream-white dark:bg-charcoal-gray rounded-2xl shadow-lg p-6 w-full max-w-md transform transition-all duration-300 ease-out ".concat(S?"translate-y-0 scale-100":"translate-y-10 scale-95"),children:[(0,h.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,h.jsx)("div",{children:(0,h.jsx)("h2",{className:"text-xl font-bold text-dark-navy dark:text-white",children:s()(t).format("YYYY\ub144 M\uc6d4 D\uc77c (ddd)")})}),(0,h.jsx)("button",{onClick:o,className:"text-medium-gray dark:text-light-gray hover:text-dark-navy dark:hover:text-white text-2xl transition-all duration-200 ease-in-out transform hover:scale-105",children:"\xd7"})]}),(0,h.jsx)("div",{className:"space-y-4 mb-6 max-h-60 overflow-y-auto",children:0===p.length?(0,h.jsx)("p",{className:"text-medium-gray dark:text-light-gray text-center py-4",children:"\uae30\ub85d\ub41c \uadfc\ubb34\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc9c0\uae08 \ubc14\ub85c \uccab \uadfc\ubb34\ub97c \ucd94\uac00\ud574\ubcf4\uc138\uc694!"}):p.map(e=>{var t,r,a;return(0,h.jsxs)("div",{className:"flex justify-between items-center py-3 border-b border-gray-100 dark:border-gray-600 last:border-b-0 rounded-md",children:[(0,h.jsxs)("div",{className:"flex-grow cursor-pointer p-2 -m-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 active:bg-gray-200 dark:active:bg-gray-600 transition-colors duration-150",onClick:()=>L(e),children:[(null===(t=e.jobs)||void 0===t?void 0:t.job_name)&&(0,h.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium self-start mb-1",style:(0,x.B)(e.jobs,!0),children:e.jobs.job_name}),(0,h.jsxs)("p",{className:"text-lg font-bold text-dark-navy dark:text-white",children:["+",(e.daily_wage||0).toLocaleString(),"\uc6d0"]}),(0,h.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:[(null===(r=e.start_time)||void 0===r?void 0:r.slice(0,5))||"--:--"," ~ ",(null===(a=e.end_time)||void 0===a?void 0:a.slice(0,5))||"--:--"]}),(0,h.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:["(",f(e.start_time,e.end_time),")"]}),(e.meal_allowance||0)>0&&(0,h.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:["\uc2dd\ub300: ",(e.meal_allowance||0).toLocaleString(),"\uc6d0"]}),e.notes&&(0,h.jsxs)("p",{className:"text-sm text-medium-gray dark:text-light-gray",children:["\ube44\uace0: ",e.notes]})]}),(0,h.jsxs)("div",{className:"flex flex-col space-y-2 ml-4",children:[(0,h.jsx)("button",{onClick:()=>L(e),className:"p-2 rounded-full text-medium-gray dark:text-light-gray hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200","aria-label":"\ud3b8\uc9d1",children:(0,h.jsx)(m.A,{size:20})}),(0,h.jsx)("button",{onClick:()=>(async e=>{i&&b("\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc5b4\uc694?",async()=>{const{error:t}=await n.N.from("work_records").delete().eq("id",e).eq("user_id",i.user.id);t?(console.error("Error deleting record:",t),v("\uc0ad\uc81c\ud558\uc9c0 \ubabb\ud588\uc5b4\uc694","error")):(v("\uc0ad\uc81c\ud588\uc5b4\uc694","success"),D())})})(e.id),className:"p-2 rounded-full text-coral-pink hover:bg-red-100 dark:hover:bg-red-900 transition-colors duration-200","aria-label":"\uc0ad\uc81c",children:(0,h.jsx)(u.A,{size:20})})]})]},e.id)})}),(0,h.jsxs)("div",{className:"mt-6 flex flex-col justify-between items-center p-4 bg-cream-white dark:bg-charcoal-gray border-t border-gray-200 dark:border-gray-700 rounded-b-2xl -mx-6 -mb-6 space-y-3",children:[E>0&&(0,h.jsxs)("p",{className:"text-lg font-semibold text-mint-green dark:text-mint-green-light mb-4",children:["\ucd1d \uc77c\uae09: ",(E||0).toLocaleString(),"\uc6d0"]}),(0,h.jsxs)("div",{className:"flex flex-col gap-3 w-full",children:[(0,h.jsx)("button",{onClick:()=>{F(null),j(!0)},className:"px-3 py-2 bg-mint-green text-white rounded-full font-medium hover:bg-mint-green-dark focus:outline-none focus:ring-2 focus:ring-mint-green focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105 flex items-center justify-center space-x-2 w-full",children:(0,h.jsx)(g.A,{size:25,className:"font-black"})}),(0,h.jsx)("button",{onClick:o,className:"px-3 py-2 bg-medium-gray text-white rounded-full font-medium hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-medium-gray focus:ring-opacity-50 transition-all duration-200 ease-in-out transform hover:scale-105 w-full",children:"\ub2eb\uae30"})]})]})]})}),w&&(0,h.jsx)(l.default,{selectedDate:t,isOpen:w,onClose:()=>{j(!1),F(null),D();try{window.dispatchEvent(new Event("work-records-changed"))}catch(e){}},session:i,jobs:y,recordToEdit:N,size:"large"})]}):null}}}]);